<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–°è¦ãŠç”³ã—è¾¼ã¿ - ä¹å·é›»åŠ›æ ªå¼ä¼šç¤¾</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* ç”³è¾¼ãƒšãƒ¼ã‚¸å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        body {
            background: linear-gradient(135deg, #007BC2 0%, #005A91 40%, #003d6b 100%);
            min-height: 100vh;
            margin: 0;
            padding: 0;
            font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Yu Gothic', sans-serif;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ†ã®ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚° */
        .header-section {
            background: white;
            color: #333;
            padding: 12px 0;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-bottom: 1px solid #e6eaf2;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .company-logo {
            display: flex;
            align-items: center;
        }

        .company-logo img {
            height: 40px;
            width: auto;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .language-selector {
            position: relative;
        }

        .language-selector select {
            padding: 6px 10px;
            border: 1px solid #e6eaf2;
            border-radius: 6px;
            background: white;
            font-size: 0.85rem;
            cursor: pointer;
            appearance: none;
            padding-right: 25px;
            background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 4 5"><path fill="%23007BC2" d="M2 0L0 2h4zm0 5L0 3h4z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 6px center;
            background-size: 8px;
        }

        .contact-btn {
            background: linear-gradient(135deg, #007BC2 0%, #005A91 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 18px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            white-space: nowrap;
        }

        .contact-btn:hover {
            background: linear-gradient(135deg, #005A91 0%, #003d6b 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 123, 194, 0.3);
        }

        .page-title {
            display: none;
        }

        .application-container {
            max-width: 900px;
            margin: 80px auto 0 auto;
            padding: 40px 20px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 3;
        }
        
        .application-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .application-title {
            font-size: 1.8rem;
            color: #007BC2;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .application-subtitle {
            font-size: 1rem;
            color: #666;
            margin-bottom: 30px;
        }
        
        /* ã‚¹ãƒ†ãƒƒãƒ—é€²æ—ãƒãƒ¼ - ä¹å·é›»åŠ›ã‚¹ã‚¿ã‚¤ãƒ« */
        .progress-container {
            background: white;
            padding: 20px;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0, 123, 194, 0.1);
            text-align: center;
        }

        .progress-title {
            display: none;
        }
        
        .steps-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0;
            margin: 0 auto;
            max-width: 600px;
        }
        
        .step-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            position: relative;
        }
        
        .step-item:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 25px;
            right: -50%;
            width: calc(100% - 20px);
            height: 3px;
            background: #e0e6ed;
            z-index: 1;
        }
        
        .step-item.active:not(:last-child)::after,
        .step-item.completed:not(:last-child)::after {
            background: linear-gradient(90deg, #007BC2 0%, #005A91 100%);
        }
        
        .step-number {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #e0e6ed;
            color: #999;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1.1rem;
            position: relative;
            z-index: 2;
            margin-bottom: 12px;
            border: 3px solid #f8f9fa;
            transition: all 0.3s ease;
        }
        
        .step-item.active .step-number {
            background: linear-gradient(135deg, #007BC2 0%, #005A91 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(0, 123, 194, 0.3);
            transform: scale(1.05);
        }
        
        .step-item.completed .step-number {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }
        
        .step-title {
            font-size: 0.85rem;
            color: #666;
            text-align: center;
            line-height: 1.4;
            font-weight: 500;
            min-height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .step-item.active .step-title {
            color: #007BC2;
            font-weight: 600;
        }

        .step-item.completed .step-title {
            color: #28a745;
            font-weight: 600;
        }
        
        /* ãƒ•ã‚©ãƒ¼ãƒ ã‚¹ãƒ†ãƒƒãƒ— */
        .form-step {
            display: none;
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0;
        }
        
        .form-step.active {
            display: block;
        }
        
        .step-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .step-header h3 {
            font-size: 1.5rem;
            color: #007BC2;
            margin-bottom: 10px;
        }
        
        .step-header p {
            color: #666;
            font-size: 1rem;
        }
        
        .form-section {
            margin-bottom: 30px;
        }
        
        .form-section h4 {
            font-size: 1.2rem;
            color: #007BC2;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e6f2ff;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group.full-width {
            grid-column: 1 / -1;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }
        
        .form-input {
            width: 100%;
            padding: 15px 18px;
            border: 2px solid #e6eaf2;
            border-radius: 12px;
            font-size: 1rem;
            background: #fafbfc;
            font-family: inherit;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #007BC2;
            background: white;
            box-shadow: 0 0 0 4px rgba(0, 123, 194, 0.08);
        }

        .form-input:hover {
            border-color: #b8d4ea;
            background: white;
        }
        
        .form-select {
            width: 100%;
            padding: 15px 18px;
            border: 2px solid #e6eaf2;
            border-radius: 12px;
            font-size: 1rem;
            background: #fafbfc;
            cursor: pointer;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 4 5"><path fill="%23007BC2" d="M2 0L0 2h4zm0 5L0 3h4z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 18px center;
            background-size: 12px;
            padding-right: 50px;
            font-family: inherit;
            position: relative;
        }

        .form-select:focus {
            outline: none;
            border-color: #007BC2;
            background: white;
            box-shadow: 0 0 0 4px rgba(0, 123, 194, 0.08);
        }

        .form-select:hover {
            border-color: #b8d4ea;
            background: white;
        }

        /* ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚ˆã‚Šç›®ç«‹ãŸã›ã‚‹ */
        .form-select::after {
            content: '';
            position: absolute;
            right: 18px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 8px solid #007BC2;
            pointer-events: none;
        }

        .form-select:hover::after {
            border-top-color: #005A91;
        }
        
        .form-textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            min-height: 100px;
            resize: vertical;
            font-family: inherit;
        }
        
        .form-textarea:focus {
            outline: none;
            border-color: #007BC2;
        }
        
        .required {
            color: #ef4444;
            margin-left: 4px;
        }
        
        .form-actions {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid #e2e8f0;
        }
        
        .btn-next {
            background: linear-gradient(135deg, #007BC2 0%, #005A91 100%);
            color: white;
            border: none;
            padding: 14px 35px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 0.05em;
            box-shadow: 0 3px 10px rgba(0, 123, 194, 0.1);
        }
        
        .btn-next:hover {
            background: linear-gradient(135deg, #005A91 0%, #003d6b 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 123, 194, 0.3);
        }
        
        .btn-prev {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
            color: white;
            border: none;
            padding: 14px 35px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 0.05em;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .btn-prev:hover {
            background: linear-gradient(135deg, #5a6268 0%, #495057 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .btn-submit {
            background: #10b981;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-submit:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }
        
        .btn-back {
            background: transparent;
            color: #007BC2;
            border: 2px solid #007BC2;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn-back:hover {
            background: #007BC2;
            color: white;
        }
        
        /* ãƒ—ãƒ©ãƒ³é¸æŠã‚«ãƒ¼ãƒ‰ */
        .plan-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .plan-card {
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }
        
        .plan-card:hover {
            border-color: #007BC2;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 123, 194, 0.1);
        }
        
        .plan-card.selected {
            border-color: #007BC2;
            background: #f8fbff;
        }
        
        .plan-card h4 {
            color: #007BC2;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .plan-card p {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .plan-features {
            list-style: none;
            padding: 0;
            margin-bottom: 15px;
        }
        
        .plan-features li {
            color: #666;
            margin-bottom: 5px;
            padding-left: 20px;
            position: relative;
        }
        
        .plan-features li::before {
            content: 'âœ“';
            position: absolute;
            left: 0;
            color: #10b981;
            font-weight: bold;
        }
        
        .plan-price {
            font-size: 1.1rem;
            font-weight: bold;
            color: #007BC2;
        }
        
        /* æƒ…å ±è¡¨ç¤ºã‚¨ãƒªã‚¢ */
        .info-display {
            background: #f8fbff;
            border: 1px solid #e6f2ff;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .info-display h4 {
            color: #007BC2;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e6f2ff;
        }
        
        .info-item:last-child {
            border-bottom: none;
        }
        
        .info-label {
            font-weight: 600;
            color: #333;
        }
        
        .info-value {
            color: #007BC2;
        }

        /* ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã¨ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .radio-group {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .radio-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 0.95rem;
        }

        .radio-label input[type="radio"] {
            margin-right: 8px;
            transform: scale(1.2);
        }

        .btn-address-search {
            background: #007BC2;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background 0.3s ease;
            white-space: nowrap;
        }

        .btn-address-search:hover {
            background: #005A91;
        }

        .btn-add-phone,
        .btn-remove-phone {
            background: #ff9933;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background 0.3s ease;
            margin: 0 5px;
        }

        .btn-add-phone:hover,
        .btn-remove-phone:hover {
            background: #e68a00;
        }

        .btn-remove-phone {
            background: #666;
        }

        .btn-remove-phone:hover {
            background: #555;
        }

        .result-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            align-items: start;
        }

        .discount-info-container .info-display {
            position: sticky;
            top: 100px;
        }

        /* ãƒ¢ãƒ¼ãƒ€ãƒ«ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(4px);
        }

        .modal-content {
            background: linear-gradient(135deg, #ffffff 0%, #f8fbff 100%);
            border-radius: 20px;
            max-width: 480px;
            width: 90%;
            box-shadow: 0 25px 80px rgba(0, 123, 194, 0.15), 0 10px 40px rgba(0, 0, 0, 0.1);
            animation: modalSlideIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            border: 1px solid rgba(0, 123, 194, 0.1);
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-40px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            padding: 15px 20px 12px 20px;
            border-bottom: 1px solid rgba(0, 123, 194, 0.1);
            background: white;
            border-radius: 20px 20px 0 0;
            position: relative;
        }

        .modal-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #007BC2 0%, #005A91 100%);
            border-radius: 2px;
        }

        .modal-header-content {
            display: flex;
            align-items: center;
            gap: 20px;
            flex: 1;
        }

        .mirai-avatar {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mirai-icon {
            width: 35px;
            height: 35px;
            object-fit: contain;
        }

        .mirai-message h3 {
            margin: 0 0 2px 0;
            color: #007BC2;
            font-size: 1rem;
            font-weight: 700;
            line-height: 1.2;
        }

        .mirai-message p {
            margin: 0;
            color: #005A91;
            font-size: 0.8rem;
            font-weight: 500;
        }



        .modal-body {
            padding: 15px 20px;
        }

        .gas-offer-content {
            text-align: center;
        }

        .energy-icons {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 12px;
            padding: 12px;
        }

        .energy-icon {
            font-size: 2rem;
            transition: all 0.3s ease;
        }

        .energy-icon.electricity {
            color: #ffd700;
            animation: pulse 2s infinite;
        }

        .energy-icon.plus {
            color: #007BC2;
            font-weight: bold;
            font-size: 1.6rem;
        }

        .energy-icon.gas {
            color: #ff6b35;
            animation: pulse 2s infinite 0.5s;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .gas-offer-content h4 {
            color: #007BC2;
            font-size: 1.1rem;
            margin-bottom: 8px;
            font-weight: 700;
            line-height: 1.3;
        }

        .offer-description {
            color: #555;
            font-size: 0.95rem;
            margin-bottom: 15px;
            line-height: 1.4;
            font-weight: 500;
        }

        .gas-benefits {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .benefit-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: linear-gradient(135deg, #ffffff 0%, #f8fbff 100%);
            border-radius: 14px;
            border: 1px solid rgba(0, 123, 194, 0.08);
            box-shadow: 0 2px 10px rgba(0, 123, 194, 0.05);
            transition: all 0.3s ease;
        }

        .benefit-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 123, 194, 0.1);
            border-color: rgba(0, 123, 194, 0.15);
        }

        .benefit-icon {
            font-size: 1.2rem;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #007BC2 0%, #005A91 100%);
            color: white;
            border-radius: 8px;
            flex-shrink: 0;
        }

        .benefit-text {
            text-align: left;
            flex: 1;
        }

        .benefit-title {
            display: block;
            color: #007BC2;
            font-weight: 700;
            font-size: 0.85rem;
            margin-bottom: 1px;
            line-height: 1.2;
        }

        .benefit-desc {
            display: block;
            color: #666;
            font-size: 0.75rem;
            line-height: 1.2;
        }

        .modal-actions {
            padding: 15px 20px 20px 20px;
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .btn-gas-yes, .btn-gas-no {
            flex: 1;
            max-width: 190px;
            padding: 12px 18px;
            border-radius: 16px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            border: none;
            position: relative;
            overflow: hidden;
        }

        .btn-gas-yes {
            background: linear-gradient(135deg, #007BC2 0%, #005A91 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(0, 123, 194, 0.3);
        }

        .btn-gas-yes:hover {
            background: linear-gradient(135deg, #005A91 0%, #003d6b 100%);
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 123, 194, 0.4);
        }

        .btn-gas-no {
            background: linear-gradient(135deg, #ffffff 0%, #f8fbff 100%);
            color: #007BC2;
            border: 2px solid #007BC2;
            box-shadow: 0 4px 15px rgba(0, 123, 194, 0.1);
        }

        .btn-gas-no:hover {
            background: linear-gradient(135deg, #007BC2 0%, #005A91 100%);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 123, 194, 0.3);
        }

        .btn-icon {
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
                gap: 0;
            }
            
            .form-step {
                padding: 30px 20px;
            }
            
            .application-title {
                font-size: 1.8rem;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .plan-cards {
                grid-template-columns: 1fr;
            }

            .result-container {
                grid-template-columns: 1fr;
            }
            
            .steps-container {
                flex-direction: column;
                gap: 20px;
            }
            
            .step-item:not(:last-child)::after {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="header-section">
        <div class="header-content">
            <div class="company-logo">
                <img src="ä¹å·é›»åŠ›ãƒ­ã‚´.png" alt="ä¹å·é›»åŠ›æ ªå¼ä¼šç¤¾">
            </div>
            <div class="header-actions">
                <div class="language-selector">
                    <select>
                        <option value="ja">æ—¥æœ¬èª</option>
                        <option value="en">English</option>
                        <option value="ko">í•œêµ­ì–´</option>
                        <option value="zh">ä¸­æ–‡</option>
                    </select>
                </div>
                <a href="#" class="contact-btn">ãŠå•ã„åˆã‚ã›ã¯ã“ã¡ã‚‰</a>
            </div>
        </div>
    </div>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main>
        <div class="application-container">
            <!-- ã‚¹ãƒ†ãƒƒãƒ—é€²æ— -->
            <div class="progress-container">
                <div class="steps-container">
                    <div class="step-item active" id="step1">
                        <div class="step-number">1</div>
                        <div class="step-title">ãƒ—ãƒ©ãƒ³é¸æŠ</div>
                    </div>
                    <div class="step-item" id="step2">
                        <div class="step-number">2</div>
                        <div class="step-title">å¥‘ç´„æƒ…å ±</div>
                    </div>
                    <div class="step-item" id="step3">
                        <div class="step-number">3</div>
                        <div class="step-title">ç¢ºèª</div>
                    </div>
                    <div class="step-item" id="step4">
                        <div class="step-number">4</div>
                        <div class="step-title">å®Œäº†</div>
                    </div>
                </div>
            </div>

            <!-- Step 1: å¥‘ç´„ãƒ—ãƒ©ãƒ³è¨­å®š -->
            <div class="form-step active" id="step1Form">
                <div class="step-header">
                    <h3>Step 1: å¥‘ç´„ãƒ—ãƒ©ãƒ³ãŠã‚ˆã³ä»˜å¸¯å¥‘ç´„ã®è¨­å®š</h3>
                    <p>ã”å®¶æ—æ§‹æˆã‚„åˆ©ç”¨çŠ¶æ³ã«åŸºã¥ã„ã¦ã€æœ€é©ãªãƒ—ãƒ©ãƒ³ã‚’ã”ææ¡ˆã—ã¾ã™</p>
                </div>

                <!-- äº‹å‰æƒ…å ±è¡¨ç¤ºï¼ˆãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‹ã‚‰ã®æƒ…å ±ãŒã‚ã‚‹å ´åˆï¼‰ -->
                <div class="info-display" id="preInfo" style="display: none;">
                    <h4>ğŸ“‹ ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã§ç¢ºèªã—ãŸæƒ…å ±</h4>
                    <div class="info-grid" id="preInfoGrid">
                        <!-- å‹•çš„ã«æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã‚‹ -->
                    </div>
                </div>

                <div class="form-section">
                    <h4>ãƒ©ã‚¤ãƒ•ã‚¹ã‚¿ã‚¤ãƒ«ã«ã¤ã„ã¦ãŠèã‹ã›ãã ã•ã„</h4>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">å®¶æ—æ§‹æˆ<span class="required">*</span></label>
                            <select class="form-select" id="familyComposition" name="familyComposition" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="1äºº">1äºº</option>
                                <option value="2äºº">2äºº</option>
                                <option value="3äºº">3äºº</option>
                                <option value="4äºº">4äºº</option>
                                <option value="5äººä»¥ä¸Š">5äººä»¥ä¸Š</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">ã†ã¡ã€3æ­³æœªæº€ã®ãŠå­æ§˜ã®äººæ•°<span class="required">*</span></label>
                            <select class="form-select" id="youngChildren" name="youngChildren" required>
                                <option value="0äºº">0äºº</option>
                                <option value="1äºº">1äºº</option>
                                <option value="2äºº">2äºº</option>
                                <option value="3äººä»¥ä¸Š">3äººä»¥ä¸Š</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">1å¹´ä»¥å†…ã«ä¹å·å¤–ã‹ã‚‰ç§»ä½<span class="required">*</span></label>
                            <select class="form-select" id="migrated" name="migrated" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="yes">ã¯ã„</option>
                                <option value="no">ã„ã„ãˆ</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">ã”å¸Œæœ›ã®ã‚¢ãƒ³ãƒšã‚¢æ•°<span class="required">*</span></label>
                            <select class="form-select" id="amperage" name="capacity" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="10">10Aï¼ˆç…§æ˜ã€ãƒ†ãƒ¬ãƒ“ãªã©æœ€ä½é™ï¼‰</option>
                                <option value="15">15Aï¼ˆï¼‹PCã€é›»å­ãƒ¬ãƒ³ã‚¸ãªã©ï¼‰</option>
                                <option value="20">20Aï¼ˆï¼‹ãƒ‰ãƒ©ã‚¤ãƒ¤ãƒ¼ã€ã‚¨ã‚¢ã‚³ãƒ³ãªã©ï¼‰</option>
                                <option value="30">30Aï¼ˆï¼‹è¤‡æ•°ã®å®¶é›»ã‚’åŒæ™‚ã«åˆ©ç”¨ï¼‰</option>
                                <option value="40">40Aï¼ˆå®¶æ—å‘ã‘ã€‚è¤‡æ•°ã®ã‚¨ã‚¢ã‚³ãƒ³ã€èª¿ç†å®¶é›»ã‚’åŒæ™‚ã«åˆ©ç”¨ï¼‰</option>
                                <option value="50">50Aï¼ˆã‚ªãƒ¼ãƒ«é›»åŒ–ã‚„å¤§å®¶æ—å‘ã‘ï¼‰</option>
                                <option value="60">60Aï¼ˆå¤šãã®å®¶é›»ã‚’åŒæ™‚ã«åˆ©ç”¨ï¼‰</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">æ˜¼é–“ã®ã‚ã‚‹ç¨‹åº¦ã®åˆ©ç”¨è¦‹è¾¼ã¿<small> (ãƒšãƒƒãƒˆ,åœ¨å®…ç­‰)</small><span class="required">*</span></label>
                            <select class="form-select" id="daytimeUsage" name="daytimeUsage" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="yes">ã‚ã‚‹ç¨‹åº¦ã®åˆ©ç”¨è¦‹è¾¼ã¿ãŒã‚ã‚‹</option>
                                <option value="no">æ˜¼é–“ã¯ãã“ã¾ã§åˆ©ç”¨ã—ãªã„</option>
                            </select>
                        </div>
    
                        <div class="form-group">
                            <label class="form-label">ãŠä½ã¾ã„ã¯ã‚ªãƒ¼ãƒ«é›»åŒ–<span class="required">*</span></label>
                            <select class="form-select" id="allElectric" name="allElectric" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="yes">ã¯ã„</option>
                                <option value="no">ã„ã„ãˆ</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ç‰¹å®šè¨­å‚™ã‚’ãŠæŒã¡ã§ã™ã‹ï¼Ÿ</label>
                            <div id="equipmentCheckboxes" style="padding-top: 5px;">
                                <label style="margin-right: 15px;"><input type="checkbox" name="equipment" value="ecocute"> ã‚¨ã‚³ã‚­ãƒ¥ãƒ¼ãƒˆ</label>
                                <label style="margin-right: 15px;"><input type="checkbox" name="equipment" value="storage"> è“„é›»æ± </label>
                                <label><input type="checkbox" name="equipment" value="ev"> EV (é›»æ°—è‡ªå‹•è»Š)</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">JALãƒã‚¤ãƒ¬ãƒ¼ã‚¸ã‚’ãŠå¾—ã«è²¯ã‚ãŸã„ã§ã™ã‹ï¼Ÿ<span class="required">*</span></label>
                            <select class="form-select" id="jalMileage" name="jalMileage" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="yes">ã¯ã„</option>
                                <option value="no">ã„ã„ãˆ</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-actions" style="border-top: none; padding-top: 10px; justify-content: center;">
                        <button type="button" class="btn-next" style="background-color: #ff9933;" onclick="findPlan()">æœ€é©ãªãƒ—ãƒ©ãƒ³ã‚’æ¤œç´¢</button>
                    </div>
                </div>

                <div class="form-section" id="planResultSection" style="display: none;">
                    <div class="result-container">
                        <div class="plan-recommendation">
                            <h4>ã”ææ¡ˆãƒ—ãƒ©ãƒ³</h4>
                            <div class="plan-cards" id="planResult">
                                <!-- Results will be injected here -->
                            </div>
                        </div>
                        <div class="discount-info-container">
                             <div id="discountInfo" class="info-display" style="display: none;">
                                <h4>ğŸ‰ é©ç”¨å¯èƒ½ãªå‰²å¼•ãƒ—ãƒ©ãƒ³</h4>
                                <p id="discountText"></p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-section">
                    <h4>ä»˜å¸¯å¥‘ç´„</h4>
                    <div class="form-group full-width">
                        <label class="form-label">ä»˜å¸¯å¥‘ç´„</label>
                        <select class="form-select" name="additional">
                            <option value="">ãªã—</option>
                            <option value="notification">ä½¿ç”¨é‡é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹</option>
                            <option value="eco">çœã‚¨ãƒã‚¢ãƒ‰ãƒã‚¤ã‚¹</option>
                        </select>
                    </div>
                </div>

                <div class="form-actions">
                    <a href="index.html" class="btn-back">æˆ»ã‚‹</a>
                    <button type="button" class="btn-next" id="step1NextButton" onclick="nextStep()" style="display: none;">æ¬¡ã¸é€²ã‚€</button>
                </div>
            </div>

            <!-- Step 2: ãŠå®¢æ§˜æƒ…å ±å…¥åŠ› -->
            <div class="form-step" id="step2Form">
                <form>
                    <div class="step-header">
                        <h3>Step 2: ãŠå®¢æ§˜æƒ…å ±ã®å…¥åŠ›</h3>
                        <p>ç”³ã—è¾¼ã¿ã«å¿…è¦ãªåŸºæœ¬æƒ…å ±ã‚’ã”å…¥åŠ›ãã ã•ã„</p>
                    </div>

                <div class="form-section">
                    <h4>ãŠç”³è¾¼è€…æƒ…å ±</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">å§“<span class="required">*</span></label>
                            <input type="text" class="form-input" name="lastName" placeholder="ä¾‹ï¼šä¹å·" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">å<span class="required">*</span></label>
                            <input type="text" class="form-input" name="firstName" placeholder="ä¾‹ï¼šå¤ªéƒ" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">å§“ï¼ˆãƒ•ãƒªã‚¬ãƒŠï¼‰<span class="required">*</span></label>
                            <input type="text" class="form-input" name="lastNameKana" placeholder="ä¾‹ï¼šã‚­ãƒ¥ã‚¦ã‚·ãƒ¥ã‚¦" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">åï¼ˆãƒ•ãƒªã‚¬ãƒŠï¼‰<span class="required">*</span></label>
                            <input type="text" class="form-input" name="firstNameKana" placeholder="ä¾‹ï¼šã‚¿ãƒ­ã‚¦" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ãŠç”³è¾¼è€…ã¨å¥‘ç´„åç¾©äººã®é–¢ä¿‚<span class="required">*</span></label>
                            <select class="form-select" name="relationship" required>
                                <option value="æœ¬äºº" selected>æœ¬äºº</option>
                                <option value="é…å¶è€…">é…å¶è€…</option>
                                <option value="å®¶æ—ãƒ»è¦ªæˆš">å®¶æ—ãƒ»è¦ªæˆš</option>
                                <option value="å®¶ä¸»ãƒ»ç®¡ç†äºº">å®¶ä¸»ãƒ»ç®¡ç†äºº</option>
                                <option value="ãã®ä»–">ãã®ä»–</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹<span class="required">*</span></label>
                            <input type="email" class="form-input" name="email" placeholder="ä¾‹ï¼štaro@example.com" required>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h4>ä½æ‰€ï¼ˆã”ä½¿ç”¨å ´æ‰€ï¼‰</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">éƒµä¾¿ç•ªå·<span class="required">*</span></label>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <input type="text" class="form-input" name="postalCode" placeholder="ä¾‹ï¼š810-0001" required style="flex: 1;">
                                <button type="button" class="btn-address-search" onclick="searchAddress()">ä½æ‰€æ¤œç´¢</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">éƒ½é“åºœçœŒ<span class="required">*</span></label>
                            <select class="form-select" name="prefecture" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="ç¦å²¡çœŒ">ç¦å²¡çœŒ</option>
                                <option value="ä½è³€çœŒ">ä½è³€çœŒ</option>
                                <option value="é•·å´çœŒ">é•·å´çœŒ</option>
                                <option value="ç†Šæœ¬çœŒ">ç†Šæœ¬çœŒ</option>
                                <option value="å¤§åˆ†çœŒ">å¤§åˆ†çœŒ</option>
                                <option value="å®®å´çœŒ">å®®å´çœŒ</option>
                                <option value="é¹¿å…å³¶çœŒ">é¹¿å…å³¶çœŒ</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">å¸‚åŒºç”ºæ‘<span class="required">*</span></label>
                            <input type="text" class="form-input" name="city" placeholder="ä¾‹ï¼šç¦å²¡å¸‚ä¸­å¤®åŒº" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ç•ªåœ°ã€å·<span class="required">*</span></label>
                            <input type="text" class="form-input" name="address1" placeholder="ä¾‹ï¼šæ¸¡è¾ºé€š2ä¸ç›®1ç•ª82å·" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ä½å±…ã‚¿ã‚¤ãƒ—<span class="required">*</span></label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="housingType" value="æˆ¸å»ºä½å®…" required>
                                    <span>æˆ¸å»ºä½å®…</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="housingType" value="é›†åˆä½å®…" required>
                                    <span>é›†åˆä½å®…ï¼ˆãƒãƒ³ã‚·ãƒ§ãƒ³ãƒ»ã‚¢ãƒ‘ãƒ¼ãƒˆç­‰ï¼‰</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">å»ºç‰©åã€éƒ¨å±‹ç•ªå·</label>
                            <input type="text" class="form-input" name="address2" placeholder="ä¾‹ï¼šä¹å·é›»åŠ›ãƒ“ãƒ« 101å·å®¤">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h4>é€£çµ¡å…ˆæƒ…å ±</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ã”å¥‘ç´„è€…ã®é›»è©±ç•ªå·<span class="required">*</span></label>
                            <input type="tel" class="form-input" name="phone1" placeholder="ä¾‹ï¼š092-761-3030" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">é›»è©±ç•ªå·åŒºåˆ†<span class="required">*</span></label>
                            <select class="form-select" name="phoneType1" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="è‡ªå®…">è‡ªå®…</option>
                                <option value="æºå¸¯">æºå¸¯</option>
                                <option value="é…å¶è€…">é…å¶è€…</option>
                                <option value="å®¶æ—ãƒ»è¦ªæˆš">å®¶æ—ãƒ»è¦ªæˆš</option>
                                <option value="å®¶ä¸»ãƒ»ç®¡ç†äºº">å®¶ä¸»ãƒ»ç®¡ç†äºº</option>
                                <option value="äº‹å‹™æ‰€">äº‹å‹™æ‰€</option>
                                <option value="ãã®ä»–">ãã®ä»–</option>
                            </select>
                        </div>
                    </div>
                    <div id="phone2Section" style="display: none;">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">é›»è©±ç•ªå·2</label>
                                <input type="tel" class="form-input" name="phone2" placeholder="ä¾‹ï¼š090-1234-5678">
                            </div>
                            <div class="form-group">
                                <label class="form-label">é›»è©±ç•ªå·2åŒºåˆ†</label>
                                <select class="form-select" name="phoneType2">
                                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                    <option value="è‡ªå®…">è‡ªå®…</option>
                                    <option value="æºå¸¯">æºå¸¯</option>
                                    <option value="é…å¶è€…">é…å¶è€…</option>
                                    <option value="å®¶æ—ãƒ»è¦ªæˆš">å®¶æ—ãƒ»è¦ªæˆš</option>
                                    <option value="å®¶ä¸»ãƒ»ç®¡ç†äºº">å®¶ä¸»ãƒ»ç®¡ç†äºº</option>
                                    <option value="äº‹å‹™æ‰€">äº‹å‹™æ‰€</option>
                                    <option value="ãã®ä»–">ãã®ä»–</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" style="text-align: center; margin-top: 15px;">
                        <button type="button" class="btn-add-phone" id="addPhoneBtn" onclick="addPhone2()">é›»è©±ç•ªå·2ã‚’è¿½åŠ </button>
                        <button type="button" class="btn-remove-phone" id="removePhoneBtn" onclick="removePhone2()" style="display: none;">é›»è©±ç•ªå·2ã‚’å‰Šé™¤</button>
                    </div>
                </div>

                

                <div class="form-actions">
                    <button type="button" class="btn-prev" onclick="prevStep()">å‰ã¸æˆ»ã‚‹</button>
                    <button type="button" class="btn-next" onclick="nextStep()">æ¬¡ã¸é€²ã‚€</button>
                </div>
                </form>
            </div>

            <!-- Step 3: åˆ©ç”¨é–‹å§‹æ—¥ãƒ»æ”¯æ‰•æ–¹æ³•è¨­å®š -->
            <div class="form-step" id="step3Form">
                <form>
                    <div class="step-header">
                        <h3>Step 3: ã”åˆ©ç”¨é–‹å§‹æ—¥ã€æ”¯æ‰•æ–¹æ³•ã®è¨­å®š</h3>
                        <p>åˆ©ç”¨é–‹å§‹æ—¥ã¨ãŠæ”¯æ‰•ã„æ–¹æ³•ã‚’ã”è¨­å®šãã ã•ã„</p>
                    </div>

                                 <div class="form-section">
                     <h4>é›»æ°—ã®åˆ©ç”¨é–‹å§‹æ—¥ã®è¨­å®š</h4>
                     <div class="form-group full-width">
                         <label class="form-label">ä½¿ç”¨é–‹å§‹å¸Œæœ›æ—¥<span class="required">*</span></label>
                         <input type="date" class="form-input" name="startDate" required>
                     </div>
                     <div class="info-display">
                         <h4>ğŸ“… åˆ©ç”¨é–‹å§‹æ—¥ã«ã¤ã„ã¦</h4>
                         <p>â€¢ ç”³ã—è¾¼ã¿æ—¥ã‹ã‚‰æœ€çŸ­ã§3å–¶æ¥­æ—¥å¾Œã‹ã‚‰åˆ©ç”¨é–‹å§‹å¯èƒ½ã§ã™<br>
                         â€¢ å·¥äº‹ãŒå¿…è¦ãªå ´åˆã¯ã€åˆ¥é€”æ—¥ç¨‹èª¿æ•´ã‚’è¡Œã„ã¾ã™<br>
                         â€¢ ç·Šæ€¥ã®å ´åˆã¯ã€ãŠé›»è©±ã§ã”ç›¸è«‡ãã ã•ã„ï¼ˆ0120-986-807ï¼‰</p>
                     </div>
                 </div>

                                 <!-- ã‚¬ã‚¹åˆ©ç”¨ã®å ´åˆã®ã¿è¡¨ç¤ºã•ã‚Œã‚‹é …ç›® -->
                 <div class="form-section" id="gasSection" style="display: none;">
                     <h4>ã‚¬ã‚¹é–‹æ “ã«é–¢ã™ã‚‹æƒ…å ±</h4>
                     <div class="form-row">
                         <div class="form-group">
                             <label class="form-label">ã‚¬ã‚¹ä½¿ç”¨é–‹å§‹æ—¥<span class="required">*</span></label>
                             <input type="date" class="form-input" name="gasStartDate">
                         </div>
                         <div class="form-group">
                             <label class="form-label">ç«‹ã¡åˆã„å¸Œæœ›æ™‚åˆ»<span class="required">*</span></label>
                             <select class="form-select" name="gasTime">
                                 <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                 <option value="9:00-12:00">9:00-12:00</option>
                                 <option value="13:00-17:00">13:00-17:00</option>
                                 <option value="9:00-17:00">9:00-17:00ï¼ˆçµ‚æ—¥ï¼‰</option>
                             </select>
                         </div>
                     </div>
                     <div class="form-row">
                         <div class="form-group">
                             <label class="form-label">é–‹æ “ç«‹ä¼šè€…<span class="required">*</span></label>
                             <select class="form-select" name="gasWitness">
                                 <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                 <option value="ã”å¥‘ç´„è€…">ã”å¥‘ç´„è€…</option>
                                 <option value="ãŠç”³è¾¼è€…">ãŠç”³è¾¼è€…</option>
                                 <option value="ãã®ä»–">ãã®ä»–</option>
                             </select>
                         </div>
                         <div class="form-group">
                             <label class="form-label">å…±ç”¨ç„é–¢ã‚„é–€æ‰‰ã®æ–½éŒ æœ‰ç„¡<span class="required">*</span></label>
                             <div class="radio-group">
                                 <label class="radio-label">
                                     <input type="radio" name="lockStatus" value="ã‚ã‚Š">
                                     <span>ã‚ã‚Š</span>
                                 </label>
                                 <label class="radio-label">
                                     <input type="radio" name="lockStatus" value="ãªã—">
                                     <span>ãªã—</span>
                                 </label>
                             </div>
                         </div>
                     </div>
                 </div>

                                   <div class="form-section">
                      <h4>æ”¯æ‰•ã„æ–¹æ³•ã®è¨­å®š</h4>
                      <div class="form-group full-width">
                          <label class="form-label">æ”¯æ‰•ã„æ–¹æ³•<span class="required">*</span></label>
                          <select class="form-select" name="paymentMethod" required onchange="showPaymentMessage(this.value)">
                              <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                              <option value="bank">å£åº§æŒ¯æ›¿ï¼ˆæ‰‹æ•°æ–™ç„¡æ–™ï¼‰</option>
                              <option value="credit">ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰</option>
                              <option value="convenience">æ‰•è¾¼ç¥¨ã«ã‚ˆã‚‹æ”¯æ‰•ã„</option>
                          </select>
                      </div>
                      <div id="paymentMessage" style="display: none; margin-top: 15px; padding: 15px; background: #f8fbff; border: 1px solid #e6f2ff; border-radius: 8px;">
                          <p id="paymentMessageText" style="margin: 0; color: #007BC2; font-size: 0.95rem; line-height: 1.5;"></p>
                      </div>
                  </div>

                

                

                <div class="form-actions">
                    <button type="button" class="btn-prev" onclick="prevStep()">å‰ã¸æˆ»ã‚‹</button>
                    <button type="submit" class="btn-submit" onclick="submitApplication()">ç”³ã—è¾¼ã¿ã‚’å®Œäº†ã™ã‚‹</button>
                </div>
                </form>
                         </div>

             <!-- Step 4: æœ€çµ‚ç¢ºèª -->
             <div class="form-step" id="step4Form">
                 <div class="step-header">
                     <h3>Step 4: ç”³ã—è¾¼ã¿å†…å®¹ã®æœ€çµ‚ç¢ºèª</h3>
                     <p>å…¥åŠ›ã„ãŸã ã„ãŸå†…å®¹ã‚’ã”ç¢ºèªãã ã•ã„</p>
                 </div>

                 <!-- ç”³ã—è¾¼ã¿å†…å®¹ç¢ºèª -->
                 <div class="info-display">
                     <h4>ğŸ“‹ ç”³ã—è¾¼ã¿å†…å®¹ã®ç¢ºèª</h4>
                     <div class="info-grid" id="summaryGrid">
                         <!-- å‹•çš„ã«ç”³ã—è¾¼ã¿å†…å®¹ãŒè¡¨ç¤ºã•ã‚Œã‚‹ -->
                     </div>
                 </div>

                 <div class="form-actions">
                     <button type="button" class="btn-prev" onclick="prevStep()">å‰ã¸æˆ»ã‚‹</button>
                     <button type="button" class="btn-next" onclick="nextStep()">æ¬¡ã¸é€²ã‚€</button>
                 </div>
             </div>
         </div>
     </main>

    <!-- ã‚¬ã‚¹ã‚»ãƒƒãƒˆç¢ºèªãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— -->
    <div id="gasOfferModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-header-content">
                    <div class="mirai-avatar">
                        <img src="ä¹å·é›»åŠ›ã€Œã¿ã‚‰ã„ãã‚“ã€.png" alt="ã¿ã‚‰ã„ãã‚“" class="mirai-icon">
                    </div>
                    <div class="mirai-message">
                        <h3>ã¿ã‚‰ã„ãã‚“ã‹ã‚‰ã®ãŠã™ã™ã‚</h3>
                        <p>é›»æ°—ã¨ã‚¬ã‚¹ã‚’ã‚»ãƒƒãƒˆã§ãŠå¾—ã«ï¼</p>
                    </div>
                </div>
            </div>
            <div class="modal-body">
                <div class="gas-offer-content">
                    <div class="energy-icons">
                        <div class="energy-icon electricity">âš¡</div>
                        <div class="energy-icon plus">+</div>
                        <div class="energy-icon gas">ğŸ”¥</div>
                    </div>
                    <h4>é›»æ°—ã¨ã‚¬ã‚¹ã‚’ä¸€ç·’ã«ç”³ã—è¾¼ã¿ã¾ã›ã‚“ã‹ï¼Ÿ</h4>
                    <p class="offer-description">ã‚¬ã‚¹ã‚»ãƒƒãƒˆãƒ—ãƒ©ãƒ³ã§æ¯æœˆ<strong>300å††å‰²å¼•</strong>ãŒé©ç”¨ã•ã‚Œã¾ã™ï¼</p>
                    <div class="gas-benefits">
                        <div class="benefit-item">
                            <div class="benefit-icon">ğŸ’°</div>
                            <div class="benefit-text">
                                <span class="benefit-title">ãŠå¾—ãªã‚»ãƒƒãƒˆå‰²å¼•</span>
                                <span class="benefit-desc">æ¯æœˆ300å††ã®å‰²å¼•ãŒé©ç”¨</span>
                            </div>
                        </div>
                        <div class="benefit-item">
                            <div class="benefit-icon">âš¡</div>
                            <div class="benefit-text">
                                <span class="benefit-title">ä¸€åº¦ã®æ‰‹ç¶šãã§å¯¾å¿œå®Œäº†</span>
                                <span class="benefit-desc">é¢å€’ãªæ‰‹ç¶šããŒç°¡å˜ã«</span>
                            </div>
                        </div>
                        <div class="benefit-item">
                            <div class="benefit-icon">ğŸ“Š</div>
                            <div class="benefit-text">
                                <span class="benefit-title">åˆ©ç”¨é‡ãƒ»æ–™é‡‘ã®ä¸€å…ƒç®¡ç†</span>
                                <span class="benefit-desc">å…‰ç†±è²»ã‚’ã¾ã¨ã‚ã¦ç¢ºèª</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn-gas-yes" onclick="selectGasSet(true)">
                    <span class="btn-icon">âš¡ğŸ”¥</span>
                    ã‚¬ã‚¹ã¨é›»æ°—ã‚’ç”³ã—è¾¼ã¿
                </button>
                <button type="button" class="btn-gas-no" onclick="selectGasSet(false)">
                    <span class="btn-icon">âš¡</span>
                    é›»æ°—ã®ã¿ç”³ã—è¾¼ã¿
                </button>
            </div>
        </div>
    </div>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>ä¹å·é›»åŠ›æ ªå¼ä¼šç¤¾</h4>
                    <p>ã€’810-8720<br>
                    ç¦å²¡çœŒç¦å²¡å¸‚ä¸­å¤®åŒºæ¸¡è¾ºé€š2ä¸ç›®1ç•ª82å·<br>
                    TEL: 092-761-3030</p>
                </div>
                <div class="footer-section">
                    <h4>ã‚µãƒãƒ¼ãƒˆ</h4>
                    <ul class="footer-links">
                        <li><a href="#">ã‚ˆãã‚ã‚‹è³ªå•</a></li>
                        <li><a href="#">ãŠå•ã„åˆã‚ã›</a></li>
                        <li><a href="#">ã‚µã‚¤ãƒˆãƒãƒƒãƒ—</a></li>
                        <li><a href="#">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 ä¹å·é›»åŠ›æ ªå¼ä¼šç¤¾ All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
                 let currentStep = 1;
         const totalSteps = 4;
        let applicationData = {};

        const planDetails = {
            smartFamily: {
                name: 'ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚¡ãƒŸãƒªãƒ¼ãƒ—ãƒ©ãƒ³',
                description: 'ã”å®¶åº­å‘ã‘ã®åŸºæœ¬çš„ãªãƒ—ãƒ©ãƒ³',
                features: ['æ™‚é–“å¸¯åˆ¥æ–™é‡‘', 'ä½¿ç”¨é‡ã«å¿œã˜ãŸå‰²å¼•', 'é•·æœŸå¥‘ç´„å‰²å¼•'],
                price: 'ä½¿ç”¨é‡ã«å¿œã˜ã¦å¤‰å‹•'
            },
            nightSelect: {
                name: 'ãƒŠã‚¤ãƒˆã‚»ãƒ¬ã‚¯ãƒˆ',
                description: 'å¤œé–“ã®é›»æ°—ä½¿ç”¨ãŒå¤šã„æ–¹å‘ã‘',
                features: ['å¤œé–“æ–™é‡‘ãŒå‰²å®‰', 'ã‚¨ã‚³ã‚­ãƒ¥ãƒ¼ãƒˆåˆ©ç”¨è€…ã«æœ€é©', 'ç”Ÿæ´»ã‚¹ã‚¿ã‚¤ãƒ«ã«åˆã‚ã›ã‚„ã™ã„'],
                price: 'å¤œé–“æ–™é‡‘: 22æ™‚ã€œç¿Œ8æ™‚'
            },
            denkaNightSelect: {
                name: 'é›»åŒ–ã§ãƒŠã‚¤ãƒˆã‚»ãƒ¬ã‚¯ãƒˆ',
                description: 'ã‚ªãƒ¼ãƒ«é›»åŒ–ä½å®…å‘ã‘ã®å¤œé–“ãŠå¾—ãƒ—ãƒ©ãƒ³',
                features: ['å¤œé–“ãƒ»ä¼‘æ—¥ã®æ–™é‡‘ãŒå‰²å®‰', 'ã‚¨ã‚³ã‚­ãƒ¥ãƒ¼ãƒˆã‚„IHã«æœ€é©', 'é›»åŒ–ä½å®…ã®å…‰ç†±è²»å‰Šæ¸›'],
                price: 'å¤œé–“ãƒ»ä¼‘æ—¥æ–™é‡‘ãŒãŠå¾—'
            },
            ohisamaHiruToku: {
                name: 'ãŠã²ã•ã¾æ˜¼ãƒˆã‚¯ãƒ—ãƒ©ãƒ³',
                description: 'å¤ªé™½å…‰ç™ºé›»ãƒ»è“„é›»æ± ã‚’ãŠæŒã¡ã®æ–¹å‘ã‘',
                features: ['æ˜¼é–“ã®è²·é›»ãŒãŠå¾—', 'è‡ªå®¶æ¶ˆè²»ã‚’ã‚µãƒãƒ¼ãƒˆ', 'ç’°å¢ƒã«ã‚„ã•ã—ã„'],
                price: 'æ˜¼é–“ï¼ˆ10æ™‚ã€œ16æ™‚ï¼‰ã®é›»æ°—æ–™é‡‘ãŒãŠå¾—'
            },
            jolightB: {
                name: 'å¾“é‡é›»ç¯B',
                description: 'ä¸€èˆ¬çš„ãªã”å®¶åº­å‘ã‘ã®æ¨™æº–ãƒ—ãƒ©ãƒ³',
                features: ['ã‚·ãƒ³ãƒ—ãƒ«ãªæ–™é‡‘ä½“ç³»', '3æ®µéšæ–™é‡‘åˆ¶', 'å®‰å®šã—ãŸä¾›çµ¦'],
                price: 'åŸºæœ¬æ–™é‡‘: å¥‘ç´„å®¹é‡Ã—å˜ä¾¡'
            },
            jalDenkiB: {
                name: 'JALã§ã‚“ãB',
                description: 'é›»æ°—æ–™é‡‘ã§ãƒã‚¤ãƒ«ãŒè²¯ã¾ã‚‹ãƒ—ãƒ©ãƒ³',
                features: ['JALãƒã‚¤ãƒ«ãŒè²¯ã¾ã‚‹', 'æ—…è¡Œå¥½ãã«ãŠã™ã™ã‚', 'å¾“é‡é›»ç¯Bã¨åŒã˜æ–™é‡‘ä½“ç³»'],
                price: 'é›»æ°—æ–™é‡‘ã«å¿œã˜ã¦ãƒã‚¤ãƒ«ä»˜ä¸'
            }
        };

        function findPlan() {
            const familyComp = document.getElementById('familyComposition').value;
            const youngChildren = document.getElementById('youngChildren').value;
            const migrated = document.getElementById('migrated').value;
            const amperage = document.getElementById('amperage').value;
            const daytimeUsage = document.getElementById('daytimeUsage').value;
            const allElectric = document.getElementById('allElectric').value;
            const equipmentCheckboxes = document.querySelectorAll('#equipmentCheckboxes input[name="equipment"]:checked');
            const equipment = Array.from(equipmentCheckboxes).map(cb => cb.value);
            const jalMileage = document.getElementById('jalMileage').value;

            if (!familyComp || !youngChildren || !amperage || !migrated || !daytimeUsage || !allElectric || !jalMileage) {
                alert('ã™ã¹ã¦ã®é …ç›®ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
                return;
            }

            const planResultSection = document.getElementById('planResultSection');
            const planResult = document.getElementById('planResult');
            const discountInfo = document.getElementById('discountInfo');
            const discountText = document.getElementById('discountText');
            planResult.innerHTML = '';
            
            let recommendedPlans = new Set();
            let discountMessages = [];

            // Discount logic
            if (youngChildren !== "0äºº") {
                discountMessages.push('ã™ãã™ãèµ¤ã¡ã‚ƒã‚“ãƒ—ãƒ©ãƒ³ï¼ˆæ¯æœˆ100å††å‰²å¼•ï¼‰');
            }
            if (migrated === 'yes') {
                discountMessages.push('IJUã‚¿ãƒ¼ãƒ³å¿œæ´ãƒ—ãƒ©ãƒ³ï¼ˆæ¯æœˆ200å††å‰²å¼•ï¼‰');
            }
            if (applicationData.gasSet === 'yes') {
                discountMessages.push('<b>ã‚¬ã‚¹ã‚»ãƒƒãƒˆãƒ—ãƒ©ãƒ³ï¼ˆæ¯æœˆ300å††å‰²å¼•ï¼‰</b>');
            }

            if (discountMessages.length > 0) {
                discountText.innerHTML = discountMessages.join('<br>');
                discountInfo.style.display = 'block';
            } else {
                discountInfo.style.display = 'none';
            }

            // Plan recommendation logic
            if (allElectric === 'yes') {
                recommendedPlans.add('denkaNightSelect');
                if (equipment.includes('storage') || equipment.includes('ev')) {
                    recommendedPlans.add('ohisamaHiruToku');
                }
            } else {
                if (daytimeUsage === 'no' || equipment.includes('ecocute')) {
                    recommendedPlans.add('nightSelect');
                } else {
                    recommendedPlans.add('smartFamily');
                }
                if (daytimeUsage === 'yes' || equipment.length > 0) {
                    recommendedPlans.add('ohisamaHiruToku');
                }
                recommendedPlans.add('jolightB');
            }
            if (jalMileage === 'yes') {
                recommendedPlans.add('jalDenkiB');
            }
            
            // Create plan cards for recommended plans
            recommendedPlans.forEach(planKey => {
                const plan = planDetails[planKey];
                const card = document.createElement('div');
                card.className = 'plan-card';
                card.setAttribute('data-plan', planKey);
                card.innerHTML = `
                    <h4>${plan.name}</h4>
                    <p>${plan.description}</p>
                    <ul class="plan-features">
                        ${plan.features.map(f => `<li>${f}</li>`).join('')}
                    </ul>
                    <div class="plan-price">${plan.price}</div>
                `;
                card.addEventListener('click', function() {
                    document.querySelectorAll('#planResult .plan-card').forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    applicationData.plan = this.getAttribute('data-plan');
                    document.getElementById('step1NextButton').style.display = 'inline-block';
                });
                planResult.appendChild(card);
            });
            
            planResultSection.style.display = 'block';
        }

        // ã‚¹ãƒ†ãƒƒãƒ—ç®¡ç†
        function showStep(step) {
            console.log('showStep() called with step:', step);
            // å…¨ã¦ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’éè¡¨ç¤º
            document.querySelectorAll('.form-step').forEach(form => {
                form.classList.remove('active');
            });
            
            // æŒ‡å®šã•ã‚ŒãŸã‚¹ãƒ†ãƒƒãƒ—ã‚’è¡¨ç¤º
            const targetForm = document.getElementById(`step${step}Form`);
            console.log('Target form found:', targetForm);
            
            if (targetForm) {
                targetForm.classList.add('active');
                console.log('Step', step, 'is now active');
            } else {
                console.error('Form for step', step, 'not found!');
            }
            
            // Step2ã¨Step3ã®å ´åˆã€ã‚¬ã‚¹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡
            if (step === 2 || step === 3) {
                toggleGasSection();
            }
            
            // ã‚¹ãƒ†ãƒƒãƒ—ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’æ›´æ–°
            updateStepIndicators(step);
        }

        function updateStepIndicators(activeStep) {
            document.querySelectorAll('.step-item').forEach((item, index) => {
                item.classList.remove('active', 'completed');
                if (index + 1 < activeStep) {
                    item.classList.add('completed');
                } else if (index + 1 === activeStep) {
                    item.classList.add('active');
                }
            });
        }

        function nextStep() {
            console.log('nextStep() called, currentStep:', currentStep);
            if (validateCurrentStep()) {
                console.log('Validation passed, saving data...');
                saveCurrentStepData();
                if (currentStep < totalSteps) {
                    currentStep++;
                    console.log('Moving to step:', currentStep);
                    showStep(currentStep);
                    if (currentStep === 3) {
                        updateSummary();
                    }
                } else {
                    console.log('Already at last step');
                }
            } else {
                console.log('Validation failed');
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
            }
        }

        function validateCurrentStep() {
            console.log('validateCurrentStep() called for step:', currentStep);
            const currentForm = document.getElementById(`step${currentStep}Form`);
            console.log('Current form found:', currentForm);
            
            if (!currentForm) {
                console.error('Form not found for step:', currentStep);
                return false;
            }
            
            const requiredFields = currentForm.querySelectorAll('[required]');
            console.log('Required fields found:', requiredFields.length);
            let isValid = true;

            for (const field of requiredFields) {
                if (!field.value.trim()) {
                    field.style.borderColor = '#ef4444';
                    isValid = false;
                    console.log('Invalid field:', field.name, 'value:', field.value);
                } else {
                    field.style.borderColor = '#e2e8f0';
                }
            }

            if (!isValid) {
                alert('å¿…é ˆé …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
                return false;
            }

            if (currentStep === 1) {
                if (!applicationData.plan) {
                    alert('ã€Œæœ€é©ãªãƒ—ãƒ©ãƒ³ã‚’æ¤œç´¢ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã€ã”å¸Œæœ›ã®ãƒ—ãƒ©ãƒ³ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
                    return false;
                }
            }

            console.log('Validation result:', isValid);
            return true;
        }

        function saveCurrentStepData() {
            console.log('saveCurrentStepData() called for step:', currentStep);
            
            if (currentStep === 1) {
                // Step1ã®å ´åˆã¯ã€å€‹åˆ¥ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‹ã‚‰å€¤ã‚’å–å¾—
                const familyComp = document.getElementById('familyComposition');
                const youngChildren = document.getElementById('youngChildren');
                const migrated = document.getElementById('migrated');
                const amperage = document.getElementById('amperage');
                const daytimeUsage = document.getElementById('daytimeUsage');
                const allElectric = document.getElementById('allElectric');
                const jalMileage = document.getElementById('jalMileage');
                
                if (familyComp) applicationData.familyComposition = familyComp.value;
                if (youngChildren) applicationData.youngChildren = youngChildren.value;
                if (migrated) applicationData.migrated = migrated.value;
                if (amperage) applicationData.capacity = amperage.value;
                if (daytimeUsage) applicationData.daytimeUsage = daytimeUsage.value;
                if (allElectric) applicationData.allElectric = allElectric.value;
                if (jalMileage) applicationData.jalMileage = jalMileage.value;
                
                // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®å€¤ã‚’å–å¾—
                const equipmentCheckboxes = document.querySelectorAll('#equipmentCheckboxes input[name="equipment"]:checked');
                applicationData.equipment = Array.from(equipmentCheckboxes).map(cb => cb.value);
                
                console.log('Step 1 data saved:', applicationData);
            } else {
                // Step2ä»¥é™ã®å ´åˆã¯ã€ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰å€¤ã‚’å–å¾—
                const currentForm = document.getElementById(`step${currentStep}Form`);
                if (currentForm && currentForm.tagName === 'FORM') {
                    const formData = new FormData(currentForm);
                    for (let [key, value] of formData.entries()) {
                        applicationData[key] = value;
                    }
                    console.log('Step', currentStep, 'data saved:', applicationData);
                } else {
                    console.error('Form not found or invalid for step:', currentStep);
                }
            }
        }

        function updateSummary() {
            const summaryGrid = document.getElementById('summaryGrid');
            
            // é©ç”¨å‰²å¼•ã®è¡¨ç¤º
            let discountText = '';
            if (applicationData.youngChildren && applicationData.youngChildren !== "0äºº") {
                discountText += 'ã™ãã™ãèµ¤ã¡ã‚ƒã‚“ãƒ—ãƒ©ãƒ³ï¼ˆæ¯æœˆ100å††å‰²å¼•ï¼‰<br>';
            }
            if (applicationData.migrated === 'yes') {
                discountText += 'IJUã‚¿ãƒ¼ãƒ³å¿œæ´ãƒ—ãƒ©ãƒ³ï¼ˆæ¯æœˆ200å††å‰²å¼•ï¼‰<br>';
            }
            if (applicationData.gasSet === 'yes') {
                discountText += '<b>ã‚¬ã‚¹ã‚»ãƒƒãƒˆãƒ—ãƒ©ãƒ³ï¼ˆæ¯æœˆ300å††å‰²å¼•ï¼‰</b><br>';
            }
            if (!discountText) {
                discountText = 'ãªã—';
            }

            summaryGrid.innerHTML = `
                <div class="info-item">
                    <span class="info-label">ç”³è¾¼è€…æ°åï¼ˆãƒ•ãƒªã‚¬ãƒŠï¼‰:</span>
                    <span class="info-value">${applicationData.lastNameKana} ${applicationData.firstNameKana}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">é¸æŠãƒ—ãƒ©ãƒ³:</span>
                    <span class="info-value">${getPlanName(applicationData.plan)}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">ã‚¬ã‚¹ã‚»ãƒƒãƒˆ:</span>
                    <span class="info-value">${applicationData.gasSet === 'yes' ? 'ã¯ã„' : 'ã„ã„ãˆ'}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">å¥‘ç´„å®¹é‡:</span>
                    <span class="info-value">${applicationData.capacity}A</span>
                </div>
                <div class="info-item">
                    <span class="info-label">é©ç”¨å‰²å¼•:</span>
                    <span class="info-value">${discountText}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">é›»è©±ç•ªå·:</span>
                    <span class="info-value">${applicationData.phone1}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹:</span>
                    <span class="info-value">${applicationData.email}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">æ”¯æ‰•ã„æ–¹æ³•:</span>
                    <span class="info-value">${getPaymentMethodName(applicationData.paymentMethod)}</span>
                </div>
            `;
        }

        function getPlanName(plan) {
            return planDetails[plan] ? planDetails[plan].name : 'æœªé¸æŠ';
        }

                 function getPaymentMethodName(method) {
             const methods = {
                 'bank': 'å£åº§æŒ¯æ›¿',
                 'credit': 'ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰',
                 'convenience': 'æ‰•è¾¼ç¥¨ã«ã‚ˆã‚‹æ”¯æ‰•ã„'
             };
             return methods[method] || 'æœªé¸æŠ';
         }

        function submitApplication() {
            if (validateCurrentStep()) {
                saveCurrentStepData();
                
                // é€ä¿¡å‡¦ç†ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                alert('ç”³ã—è¾¼ã¿ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼\n\nç¢ºèªãƒ¡ãƒ¼ãƒ«ã‚’1-2å–¶æ¥­æ—¥ä»¥å†…ã«ãŠé€ã‚Šã„ãŸã—ã¾ã™ã€‚\nã”ç™»éŒ²ã„ãŸã ã„ãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã”ç¢ºèªãã ã•ã„ã€‚');
                
                // ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
                window.location.href = 'index.html';
            }
        }

        // ãƒ—ãƒ©ãƒ³é¸æŠ
        document.querySelectorAll('.plan-card').forEach(card => {
            card.addEventListener('click', function() {
                document.querySelectorAll('.plan-card').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                
                // ãƒ—ãƒ©ãƒ³æƒ…å ±ã‚’ä¿å­˜
                const plan = this.getAttribute('data-plan');
                const planName = this.querySelector('h4').textContent;
                applicationData.plan = plan;
                applicationData.planName = planName;
            });
        });

        // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆæƒ…å ±ã¨ã‚¬ã‚¹ã‚»ãƒƒãƒˆæƒ…å ±ã‚’å–å¾—
        function loadInitialInfo() {
            const urlParams = new URLSearchParams(window.location.search);
            
            // ã‚¬ã‚¹ã‚»ãƒƒãƒˆå‰²å¼•ã®å‡¦ç†
            if (urlParams.get('gasSet') === 'true') {
                applicationData.gasSet = 'yes';
            }

            const familySize = urlParams.get('family');
            const usagePattern = urlParams.get('usage');
            const plan = urlParams.get('plan');

            if (familySize || usagePattern || plan) {
                const preInfo = document.getElementById('preInfo');
                const preInfoGrid = document.getElementById('preInfoGrid');
                
                preInfo.style.display = 'block';
                preInfoGrid.innerHTML = '';
                
                if (familySize) {
                    preInfoGrid.innerHTML += `
                        <div class="info-item">
                            <span class="info-label">å®¶æ—æ§‹æˆ:</span>
                            <span class="info-value">${familySize}</span>
                        </div>
                    `;
                }
                
                if (usagePattern) {
                    preInfoGrid.innerHTML += `
                        <div class="info-item">
                            <span class="info-label">ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³:</span>
                            <span class="info-value">${usagePattern}</span>
                        </div>
                    `;
                }
                
                if (plan) {
                    preInfoGrid.innerHTML += `
                        <div class="info-item">
                            <span class="info-label">æ¨å¥¨ãƒ—ãƒ©ãƒ³:</span>
                            <span class="info-value">${planDetails[plan] ? planDetails[plan].name : plan}</span>
                        </div>
                    `;
                    
                    // æ¨å¥¨ãƒ—ãƒ©ãƒ³ã‚’è‡ªå‹•é¸æŠï¼ˆã“ã®æ©Ÿèƒ½ã¯è³ªå•ãƒ™ãƒ¼ã‚¹ã®ææ¡ˆã«å¤‰æ›´ã•ã‚ŒãŸãŸã‚ã€ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã¾ãŸã¯å‰Šé™¤ï¼‰
                    // const planCard = document.querySelector(`[data-plan="${plan}"]`);
                    // if (planCard) {
                    //     planCard.click();
                    // }
                }
            }
        }

        // é›»è©±ç•ªå·2ã®è¿½åŠ ãƒ»å‰Šé™¤æ©Ÿèƒ½
        function addPhone2() {
            document.getElementById('phone2Section').style.display = 'block';
            document.getElementById('addPhoneBtn').style.display = 'none';
            document.getElementById('removePhoneBtn').style.display = 'inline-block';
        }

        function removePhone2() {
            document.getElementById('phone2Section').style.display = 'none';
            document.getElementById('addPhoneBtn').style.display = 'inline-block';
            document.getElementById('removePhoneBtn').style.display = 'none';
            // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ã‚’ã‚¯ãƒªã‚¢
            document.querySelector('input[name="phone2"]').value = '';
            document.querySelector('select[name="phoneType2"]').value = '';
        }

        // ä½æ‰€æ¤œç´¢æ©Ÿèƒ½ï¼ˆãƒ‡ãƒ¢ï¼‰
        function searchAddress() {
            alert('ä½æ‰€æ¤œç´¢æ©Ÿèƒ½ã¯ãƒ‡ãƒ¢ã§ã™ã€‚\nå®Ÿéš›ã®é‹ç”¨ã§ã¯éƒµä¾¿ç•ªå·APIã¨é€£æºã—ã¦è‡ªå‹•å…¥åŠ›ã•ã‚Œã¾ã™ã€‚');
        }

        // ã‚¬ã‚¹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡
        function toggleGasSection() {
            console.log('toggleGasSection() called');
            const gasSection = document.getElementById('gasSection');
            console.log('Gas section found:', gasSection);
            
            if (!gasSection) {
                console.error('Gas section not found!');
                return;
            }
            
            const gasFields = gasSection.querySelectorAll('[required]');
            console.log('Gas fields found:', gasFields.length);
            
            if (applicationData.gasSet === 'yes') {
                gasSection.style.display = 'block';
                // ã‚¬ã‚¹é–¢é€£ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å¿…é ˆã«ã™ã‚‹
                gasFields.forEach(field => {
                    field.setAttribute('required', 'required');
                });
                console.log('Gas section displayed');
            } else {
                gasSection.style.display = 'none';
                // ã‚¬ã‚¹é–¢é€£ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å¿…é ˆå±æ€§ã‚’å‰Šé™¤
                gasFields.forEach(field => {
                    field.removeAttribute('required');
                });
                console.log('Gas section hidden');
            }
        }



        // ã‚¬ã‚¹ã‚»ãƒƒãƒˆé¸æŠã®å‡¦ç†
        function selectGasSet(includeGas) {
            if (includeGas) {
                applicationData.gasSet = 'yes';
                // ã‚¬ã‚¹ã‚»ãƒƒãƒˆå‰²å¼•ã‚’å³åº§ã«è¡¨ç¤º
                showGasSetDiscount();
            } else {
                applicationData.gasSet = 'no';
            }
            
            // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’é–‰ã˜ã‚‹
            closeGasOfferModal();
            
            // Step2ã«é€²ã‚€éš›ã®ã‚¬ã‚¹ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¡¨ç¤ºåˆ¶å¾¡ã‚’æ›´æ–°
            if (currentStep === 2) {
                toggleGasSection();
            }
        }

        // ã‚¬ã‚¹ã‚»ãƒƒãƒˆå‰²å¼•ã®è¡¨ç¤º
        function showGasSetDiscount() {
            const discountInfo = document.getElementById('discountInfo');
            const discountText = document.getElementById('discountText');
            
            if (discountInfo && discountText) {
                // æ—¢å­˜ã®å‰²å¼•æƒ…å ±ãŒã‚ã‚‹å ´åˆã¯è¿½åŠ ã€ãªã„å ´åˆã¯æ–°è¦ä½œæˆ
                let currentDiscounts = discountText.innerHTML;
                if (currentDiscounts && currentDiscounts.includes('ã‚¬ã‚¹ã‚»ãƒƒãƒˆãƒ—ãƒ©ãƒ³')) {
                    return; // æ—¢ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ä½•ã‚‚ã—ãªã„
                }
                
                if (currentDiscounts) {
                    currentDiscounts += '<br><b>ã‚¬ã‚¹ã‚»ãƒƒãƒˆãƒ—ãƒ©ãƒ³ï¼ˆæ¯æœˆ300å††å‰²å¼•ï¼‰</b>';
                } else {
                    currentDiscounts = '<b>ã‚¬ã‚¹ã‚»ãƒƒãƒˆãƒ—ãƒ©ãƒ³ï¼ˆæ¯æœˆ300å††å‰²å¼•ï¼‰</b>';
                }
                
                discountText.innerHTML = currentDiscounts;
                discountInfo.style.display = 'block';
            }
        }

        // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’é–‰ã˜ã‚‹
        function closeGasOfferModal() {
            document.getElementById('gasOfferModal').style.display = 'none';
        }

        // åˆæœŸåŒ–
        window.addEventListener('load', function() {
            console.log('Page loaded, initializing...');
            loadInitialInfo();
            console.log('Initial info loaded, showing step 1...');
            showStep(1);
            
            // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ã‚¬ã‚¹ã‚»ãƒƒãƒˆç¢ºèªãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’è¡¨ç¤º
            setTimeout(() => {
                showGasOfferModal();
            }, 500);
        });

                 // ã‚¬ã‚¹ã‚»ãƒƒãƒˆç¢ºèªãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’è¡¨ç¤º
         function showGasOfferModal() {
             document.getElementById('gasOfferModal').style.display = 'flex';
         }

         // æ”¯æ‰•æ–¹æ³•ã®é¸æŠã«å¿œã˜ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
         function showPaymentMessage(paymentMethod) {
             const messageDiv = document.getElementById('paymentMessage');
             const messageText = document.getElementById('paymentMessageText');
             
             if (!paymentMethod) {
                 messageDiv.style.display = 'none';
                 return;
             }
             
             let message = '';
             switch (paymentMethod) {
                 case 'bank':
                     message = 'ä»¥é™ã¯ã€åˆ©ç”¨ã™ã‚‹å£åº§æƒ…å ±ã®å…¥åŠ›ã«ãªã‚Šã¾ã™(ãƒ‡ãƒ¢ã®ãŸã‚çœç•¥)';
                     break;
                 case 'credit':
                     message = 'ä»¥é™ã¯ã€åˆ©ç”¨ã™ã‚‹ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰æƒ…å ±ã®å…¥åŠ›ã«ãªã‚Šã¾ã™(ãƒ‡ãƒ¢ã®ãŸã‚çœç•¥)';
                     break;
                 case 'convenience':
                     message = '<strong>ï¼œæ³¨æ„ï¼</strong>ãŠæ‰‹ç¶šãã®ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–æ¨é€²ã®ãŸã‚ã€æ‰•è¾¼ç¥¨ã«ã‚ˆã‚‹æ”¯æ‰•ã«ã¤ãã¾ã—ã¦ã¯ã€æ¯æœˆ110å††ã®ç™ºè¡Œæ‰‹æ•°æ–™ãŒè¿½åŠ ã§ç™ºç”Ÿã„ãŸã—ã¾ã™ã€‚ã”ç†è§£ã¨ã”å”åŠ›ã‚’ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚';
                     break;
                 default:
                     message = '';
             }
             
             if (message) {
                 messageText.innerHTML = message;
                 messageDiv.style.display = 'block';
             } else {
                 messageDiv.style.display = 'none';
             }
         }
    </script>
</body>
</html>


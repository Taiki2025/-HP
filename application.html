<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–°è¦ãŠç”³ã—è¾¼ã¿ - ä¹å·é›»åŠ›æ ªå¼ä¼šç¤¾</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* ç”³è¾¼ãƒšãƒ¼ã‚¸å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .application-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        .application-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .application-title {
            font-size: 2.2rem;
            color: #007BC2;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .application-subtitle {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 30px;
        }
        
        /* ã‚¹ãƒ†ãƒƒãƒ—é€²æ—ãƒãƒ¼ */
        .progress-container {
            margin-bottom: 40px;
        }
        
        .steps-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
        }
        
        .step-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            position: relative;
        }
        
        .step-item:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 20px;
            left: 50%;
            width: 100%;
            height: 2px;
            background: #e2e8f0;
            z-index: 1;
        }
        
        .step-item.active:not(:last-child)::after {
            background: #007BC2;
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e2e8f0;
            color: #666;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 10px;
            position: relative;
            z-index: 2;
            transition: all 0.3s ease;
        }
        
        .step-item.active .step-number {
            background: #007BC2;
            color: white;
        }
        
        .step-item.completed .step-number {
            background: #10b981;
            color: white;
        }
        
        .step-title {
            font-size: 0.9rem;
            color: #666;
            text-align: center;
            font-weight: 500;
        }
        
        .step-item.active .step-title {
            color: #007BC2;
            font-weight: 600;
        }
        
        .step-item.completed .step-title {
            color: #10b981;
        }
        
        /* ãƒ•ã‚©ãƒ¼ãƒ ã‚¹ãƒ†ãƒƒãƒ— */
        .form-step {
            display: none;
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0;
        }
        
        .form-step.active {
            display: block;
        }
        
        .step-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .step-header h3 {
            font-size: 1.5rem;
            color: #007BC2;
            margin-bottom: 10px;
        }
        
        .step-header p {
            color: #666;
            font-size: 1rem;
        }
        
        .form-section {
            margin-bottom: 30px;
        }
        
        .form-section h4 {
            font-size: 1.2rem;
            color: #007BC2;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e6f2ff;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group.full-width {
            grid-column: 1 / -1;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }
        
        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #007BC2;
            box-shadow: 0 0 0 3px rgba(0, 123, 194, 0.1);
        }
        
        .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
            cursor: pointer;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 4 5"><path fill="%23333" d="M2 0L0 2h4zm0 5L0 3h4z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 12px;
            padding-right: 40px;
        }
        
        .form-textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            min-height: 100px;
            resize: vertical;
            font-family: inherit;
        }
        
        .form-textarea:focus {
            outline: none;
            border-color: #007BC2;
            box-shadow: 0 0 0 3px rgba(0, 123, 194, 0.1);
        }
        
        .required {
            color: #ef4444;
            margin-left: 4px;
        }
        
        .form-actions {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid #e2e8f0;
        }
        
        .btn-next {
            background: #007BC2;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-next:hover {
            background: #005A91;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 123, 194, 0.3);
        }
        
        .btn-prev {
            background: transparent;
            color: #007BC2;
            border: 2px solid #007BC2;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-prev:hover {
            background: #007BC2;
            color: white;
        }
        
        .btn-submit {
            background: #10b981;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-submit:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }
        
        .btn-back {
            background: transparent;
            color: #007BC2;
            border: 2px solid #007BC2;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn-back:hover {
            background: #007BC2;
            color: white;
        }
        
        /* ãƒ—ãƒ©ãƒ³é¸æŠã‚«ãƒ¼ãƒ‰ */
        .plan-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .plan-card {
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }
        
        .plan-card:hover {
            border-color: #007BC2;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 123, 194, 0.1);
        }
        
        .plan-card.selected {
            border-color: #007BC2;
            background: #f8fbff;
        }
        
        .plan-card h4 {
            color: #007BC2;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .plan-card p {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .plan-features {
            list-style: none;
            padding: 0;
            margin-bottom: 15px;
        }
        
        .plan-features li {
            color: #666;
            margin-bottom: 5px;
            padding-left: 20px;
            position: relative;
        }
        
        .plan-features li::before {
            content: 'âœ“';
            position: absolute;
            left: 0;
            color: #10b981;
            font-weight: bold;
        }
        
        .plan-price {
            font-size: 1.1rem;
            font-weight: bold;
            color: #007BC2;
        }
        
        /* æƒ…å ±è¡¨ç¤ºã‚¨ãƒªã‚¢ */
        .info-display {
            background: #f8fbff;
            border: 1px solid #e6f2ff;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .info-display h4 {
            color: #007BC2;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e6f2ff;
        }
        
        .info-item:last-child {
            border-bottom: none;
        }
        
        .info-label {
            font-weight: 600;
            color: #333;
        }
        
        .info-value {
            color: #007BC2;
        }

        /* ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã¨ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .radio-group {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .radio-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 0.95rem;
        }

        .radio-label input[type="radio"] {
            margin-right: 8px;
            transform: scale(1.2);
        }

        .btn-address-search {
            background: #007BC2;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background 0.3s ease;
            white-space: nowrap;
        }

        .btn-address-search:hover {
            background: #005A91;
        }

        .btn-add-phone,
        .btn-remove-phone {
            background: #ff9933;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background 0.3s ease;
            margin: 0 5px;
        }

        .btn-add-phone:hover,
        .btn-remove-phone:hover {
            background: #e68a00;
        }

        .btn-remove-phone {
            background: #666;
        }

        .btn-remove-phone:hover {
            background: #555;
        }

        .result-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            align-items: start;
        }

        .discount-info-container .info-display {
            position: sticky;
            top: 100px;
        }
        
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
                gap: 0;
            }
            
            .form-step {
                padding: 30px 20px;
            }
            
            .application-title {
                font-size: 1.8rem;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .plan-cards {
                grid-template-columns: 1fr;
            }

            .result-container {
                grid-template-columns: 1fr;
            }
            
            .steps-container {
                flex-direction: column;
                gap: 20px;
            }
            
            .step-item:not(:last-child)::after {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="header">
        <div class="header-container">
            <div class="header-top">
                <div class="logo">
                    <a href="index.html">
                        <img src="ä¹å·é›»åŠ›ãƒ­ã‚´.png" alt="ä¹å·é›»åŠ›æ ªå¼ä¼šç¤¾" class="logo-img">
                    </a>
                </div>
                <div class="header-actions">
                    <div class="utility-nav">
                        <div class="language-selector">
                            <select id="languageSelect">
                                <option value="ja">languages</option>
                                <option value="en">English</option>
                                <option value="ko">í•œêµ­ì–´</option>
                                <option value="zh">ä¸­æ–‡</option>
                            </select>
                        </div>
                        <button class="login-btn">Myä¹é›»ãƒ­ã‚°ã‚¤ãƒ³</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main>
        <div class="application-container">
            <!-- ç”³è¾¼ãƒ˜ãƒƒãƒ€ãƒ¼ -->
            <div class="application-header">
                <h1 class="application-title">æ–°è¦ãŠç”³ã—è¾¼ã¿</h1>
                <p class="application-subtitle">é›»æ°—ã®ã”åˆ©ç”¨é–‹å§‹æ‰‹ç¶šãã‚’è¡Œã„ã¾ã™</p>
            </div>

            <!-- ã‚¹ãƒ†ãƒƒãƒ—é€²æ— -->
            <div class="progress-container">
                <div class="steps-container">
                    <div class="step-item active" id="step1">
                        <div class="step-number">1</div>
                        <div class="step-title">å¥‘ç´„ãƒ—ãƒ©ãƒ³è¨­å®š</div>
                    </div>
                    <div class="step-item" id="step2">
                        <div class="step-number">2</div>
                        <div class="step-title">ãŠå®¢æ§˜æƒ…å ±å…¥åŠ›</div>
                    </div>
                    <div class="step-item" id="step3">
                        <div class="step-number">3</div>
                        <div class="step-title">åˆ©ç”¨é–‹å§‹æ—¥ãƒ»æ”¯æ‰•æ–¹æ³•</div>
                    </div>
                </div>
            </div>

            <!-- Step 1: å¥‘ç´„ãƒ—ãƒ©ãƒ³è¨­å®š -->
            <div class="form-step active" id="step1Form">
                <div class="step-header">
                    <h3>Step 1: å¥‘ç´„ãƒ—ãƒ©ãƒ³ãŠã‚ˆã³ä»˜å¸¯å¥‘ç´„ã®è¨­å®š</h3>
                    <p>ã”å®¶æ—æ§‹æˆã‚„åˆ©ç”¨çŠ¶æ³ã«åŸºã¥ã„ã¦ã€æœ€é©ãªãƒ—ãƒ©ãƒ³ã‚’ã”ææ¡ˆã—ã¾ã™</p>
                </div>

                <!-- äº‹å‰æƒ…å ±è¡¨ç¤ºï¼ˆãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‹ã‚‰ã®æƒ…å ±ãŒã‚ã‚‹å ´åˆï¼‰ -->
                <div class="info-display" id="preInfo" style="display: none;">
                    <h4>ğŸ“‹ ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã§ç¢ºèªã—ãŸæƒ…å ±</h4>
                    <div class="info-grid" id="preInfoGrid">
                        <!-- å‹•çš„ã«æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã‚‹ -->
                    </div>
                </div>

                <div class="form-section">
                    <h4>ãƒ©ã‚¤ãƒ•ã‚¹ã‚¿ã‚¤ãƒ«ã«ã¤ã„ã¦ãŠèã‹ã›ãã ã•ã„</h4>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">å®¶æ—æ§‹æˆ<span class="required">*</span></label>
                            <select class="form-select" id="familyComposition" name="familyComposition" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="1äºº">1äºº</option>
                                <option value="2äºº">2äºº</option>
                                <option value="3äºº">3äºº</option>
                                <option value="4äºº">4äºº</option>
                                <option value="5äººä»¥ä¸Š">5äººä»¥ä¸Š</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">ã†ã¡ã€3æ­³æœªæº€ã®ãŠå­æ§˜ã®äººæ•°<span class="required">*</span></label>
                            <select class="form-select" id="youngChildren" name="youngChildren" required>
                                <option value="0äºº">0äºº</option>
                                <option value="1äºº">1äºº</option>
                                <option value="2äºº">2äºº</option>
                                <option value="3äººä»¥ä¸Š">3äººä»¥ä¸Š</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">1å¹´ä»¥å†…ã«ä¹å·å¤–ã‹ã‚‰ç§»ä½<span class="required">*</span></label>
                            <select class="form-select" id="migrated" name="migrated" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="yes">ã¯ã„</option>
                                <option value="no">ã„ã„ãˆ</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">ã”å¸Œæœ›ã®ã‚¢ãƒ³ãƒšã‚¢æ•°<span class="required">*</span></label>
                            <select class="form-select" id="amperage" name="capacity" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="10">10Aï¼ˆç…§æ˜ã€ãƒ†ãƒ¬ãƒ“ãªã©æœ€ä½é™ï¼‰</option>
                                <option value="15">15Aï¼ˆï¼‹PCã€é›»å­ãƒ¬ãƒ³ã‚¸ãªã©ï¼‰</option>
                                <option value="20">20Aï¼ˆï¼‹ãƒ‰ãƒ©ã‚¤ãƒ¤ãƒ¼ã€ã‚¨ã‚¢ã‚³ãƒ³ãªã©ï¼‰</option>
                                <option value="30">30Aï¼ˆï¼‹è¤‡æ•°ã®å®¶é›»ã‚’åŒæ™‚ã«åˆ©ç”¨ï¼‰</option>
                                <option value="40">40Aï¼ˆå®¶æ—å‘ã‘ã€‚è¤‡æ•°ã®ã‚¨ã‚¢ã‚³ãƒ³ã€èª¿ç†å®¶é›»ã‚’åŒæ™‚ã«åˆ©ç”¨ï¼‰</option>
                                <option value="50">50Aï¼ˆã‚ªãƒ¼ãƒ«é›»åŒ–ã‚„å¤§å®¶æ—å‘ã‘ï¼‰</option>
                                <option value="60">60Aï¼ˆå¤šãã®å®¶é›»ã‚’åŒæ™‚ã«åˆ©ç”¨ï¼‰</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">æ˜¼é–“ã®ã‚ã‚‹ç¨‹åº¦ã®åˆ©ç”¨è¦‹è¾¼ã¿<small> (ãƒšãƒƒãƒˆ,åœ¨å®…ç­‰)</small><span class="required">*</span></label>
                            <select class="form-select" id="daytimeUsage" name="daytimeUsage" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="yes">ã‚ã‚‹ç¨‹åº¦ã®åˆ©ç”¨è¦‹è¾¼ã¿ãŒã‚ã‚‹</option>
                                <option value="no">æ˜¼é–“ã¯ãã“ã¾ã§åˆ©ç”¨ã—ãªã„</option>
                            </select>
                        </div>
    
                        <div class="form-group">
                            <label class="form-label">ãŠä½ã¾ã„ã¯ã‚ªãƒ¼ãƒ«é›»åŒ–<span class="required">*</span></label>
                            <select class="form-select" id="allElectric" name="allElectric" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="yes">ã¯ã„</option>
                                <option value="no">ã„ã„ãˆ</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ç‰¹å®šè¨­å‚™ã‚’ãŠæŒã¡ã§ã™ã‹ï¼Ÿ</label>
                            <div id="equipmentCheckboxes" style="padding-top: 5px;">
                                <label style="margin-right: 15px;"><input type="checkbox" name="equipment" value="ecocute"> ã‚¨ã‚³ã‚­ãƒ¥ãƒ¼ãƒˆ</label>
                                <label style="margin-right: 15px;"><input type="checkbox" name="equipment" value="storage"> è“„é›»æ± </label>
                                <label><input type="checkbox" name="equipment" value="ev"> EV (é›»æ°—è‡ªå‹•è»Š)</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">JALãƒã‚¤ãƒ¬ãƒ¼ã‚¸ã‚’ãŠå¾—ã«è²¯ã‚ãŸã„ã§ã™ã‹ï¼Ÿ<span class="required">*</span></label>
                            <select class="form-select" id="jalMileage" name="jalMileage" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="yes">ã¯ã„</option>
                                <option value="no">ã„ã„ãˆ</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-actions" style="border-top: none; padding-top: 10px; justify-content: center;">
                        <button type="button" class="btn-next" style="background-color: #ff9933;" onclick="findPlan()">æœ€é©ãªãƒ—ãƒ©ãƒ³ã‚’æ¤œç´¢</button>
                    </div>
                </div>

                <div class="form-section" id="planResultSection" style="display: none;">
                    <div class="result-container">
                        <div class="plan-recommendation">
                            <h4>ã”ææ¡ˆãƒ—ãƒ©ãƒ³</h4>
                            <div class="plan-cards" id="planResult">
                                <!-- Results will be injected here -->
                            </div>
                        </div>
                        <div class="discount-info-container">
                             <div id="discountInfo" class="info-display" style="display: none;">
                                <h4>ğŸ‰ é©ç”¨å¯èƒ½ãªå‰²å¼•ãƒ—ãƒ©ãƒ³</h4>
                                <p id="discountText"></p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-section">
                    <h4>ä»˜å¸¯å¥‘ç´„</h4>
                    <div class="form-group full-width">
                        <label class="form-label">ä»˜å¸¯å¥‘ç´„</label>
                        <select class="form-select" name="additional">
                            <option value="">ãªã—</option>
                            <option value="notification">ä½¿ç”¨é‡é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹</option>
                            <option value="eco">çœã‚¨ãƒã‚¢ãƒ‰ãƒã‚¤ã‚¹</option>
                        </select>
                    </div>
                </div>

                <div class="form-actions">
                    <a href="index.html" class="btn-back">æˆ»ã‚‹</a>
                    <button type="button" class="btn-next" id="step1NextButton" onclick="nextStep()" style="display: none;">æ¬¡ã¸é€²ã‚€</button>
                </div>
            </div>

            <!-- Step 2: ãŠå®¢æ§˜æƒ…å ±å…¥åŠ› -->
            <div class="form-step" id="step2Form">
                <div class="step-header">
                    <h3>Step 2: ãŠå®¢æ§˜æƒ…å ±ã®å…¥åŠ›</h3>
                    <p>ç”³ã—è¾¼ã¿ã«å¿…è¦ãªåŸºæœ¬æƒ…å ±ã‚’ã”å…¥åŠ›ãã ã•ã„</p>
                </div>

                <div class="form-section">
                    <h4>ãŠç”³è¾¼è€…æƒ…å ±</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">å§“<span class="required">*</span></label>
                            <input type="text" class="form-input" name="lastName" placeholder="ä¾‹ï¼šä¹å·" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">å<span class="required">*</span></label>
                            <input type="text" class="form-input" name="firstName" placeholder="ä¾‹ï¼šå¤ªéƒ" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">å§“ï¼ˆãƒ•ãƒªã‚¬ãƒŠï¼‰<span class="required">*</span></label>
                            <input type="text" class="form-input" name="lastNameKana" placeholder="ä¾‹ï¼šã‚­ãƒ¥ã‚¦ã‚·ãƒ¥ã‚¦" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">åï¼ˆãƒ•ãƒªã‚¬ãƒŠï¼‰<span class="required">*</span></label>
                            <input type="text" class="form-input" name="firstNameKana" placeholder="ä¾‹ï¼šã‚¿ãƒ­ã‚¦" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ãŠç”³è¾¼è€…ã¨å¥‘ç´„åç¾©äººã®é–¢ä¿‚<span class="required">*</span></label>
                            <select class="form-select" name="relationship" required>
                                <option value="æœ¬äºº" selected>æœ¬äºº</option>
                                <option value="é…å¶è€…">é…å¶è€…</option>
                                <option value="å®¶æ—ãƒ»è¦ªæˆš">å®¶æ—ãƒ»è¦ªæˆš</option>
                                <option value="å®¶ä¸»ãƒ»ç®¡ç†äºº">å®¶ä¸»ãƒ»ç®¡ç†äºº</option>
                                <option value="ãã®ä»–">ãã®ä»–</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹<span class="required">*</span></label>
                            <input type="email" class="form-input" name="email" placeholder="ä¾‹ï¼štaro@example.com" required>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h4>ä½æ‰€ï¼ˆã”ä½¿ç”¨å ´æ‰€ï¼‰</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">éƒµä¾¿ç•ªå·<span class="required">*</span></label>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <input type="text" class="form-input" name="postalCode" placeholder="ä¾‹ï¼š810-0001" required style="flex: 1;">
                                <button type="button" class="btn-address-search" onclick="searchAddress()">ä½æ‰€æ¤œç´¢</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">éƒ½é“åºœçœŒ<span class="required">*</span></label>
                            <select class="form-select" name="prefecture" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="ç¦å²¡çœŒ">ç¦å²¡çœŒ</option>
                                <option value="ä½è³€çœŒ">ä½è³€çœŒ</option>
                                <option value="é•·å´çœŒ">é•·å´çœŒ</option>
                                <option value="ç†Šæœ¬çœŒ">ç†Šæœ¬çœŒ</option>
                                <option value="å¤§åˆ†çœŒ">å¤§åˆ†çœŒ</option>
                                <option value="å®®å´çœŒ">å®®å´çœŒ</option>
                                <option value="é¹¿å…å³¶çœŒ">é¹¿å…å³¶çœŒ</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">å¸‚åŒºç”ºæ‘<span class="required">*</span></label>
                            <input type="text" class="form-input" name="city" placeholder="ä¾‹ï¼šç¦å²¡å¸‚ä¸­å¤®åŒº" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ç•ªåœ°ã€å·<span class="required">*</span></label>
                            <input type="text" class="form-input" name="address1" placeholder="ä¾‹ï¼šæ¸¡è¾ºé€š2ä¸ç›®1ç•ª82å·" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ä½å±…ã‚¿ã‚¤ãƒ—<span class="required">*</span></label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="housingType" value="æˆ¸å»ºä½å®…" required>
                                    <span>æˆ¸å»ºä½å®…</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="housingType" value="é›†åˆä½å®…" required>
                                    <span>é›†åˆä½å®…ï¼ˆãƒãƒ³ã‚·ãƒ§ãƒ³ãƒ»ã‚¢ãƒ‘ãƒ¼ãƒˆç­‰ï¼‰</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">å»ºç‰©åã€éƒ¨å±‹ç•ªå·</label>
                            <input type="text" class="form-input" name="address2" placeholder="ä¾‹ï¼šä¹å·é›»åŠ›ãƒ“ãƒ« 101å·å®¤">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h4>é€£çµ¡å…ˆæƒ…å ±</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ã”å¥‘ç´„è€…ã®é›»è©±ç•ªå·<span class="required">*</span></label>
                            <input type="tel" class="form-input" name="phone1" placeholder="ä¾‹ï¼š092-761-3030" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">é›»è©±ç•ªå·åŒºåˆ†<span class="required">*</span></label>
                            <select class="form-select" name="phoneType1" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="è‡ªå®…">è‡ªå®…</option>
                                <option value="æºå¸¯">æºå¸¯</option>
                                <option value="é…å¶è€…">é…å¶è€…</option>
                                <option value="å®¶æ—ãƒ»è¦ªæˆš">å®¶æ—ãƒ»è¦ªæˆš</option>
                                <option value="å®¶ä¸»ãƒ»ç®¡ç†äºº">å®¶ä¸»ãƒ»ç®¡ç†äºº</option>
                                <option value="äº‹å‹™æ‰€">äº‹å‹™æ‰€</option>
                                <option value="ãã®ä»–">ãã®ä»–</option>
                            </select>
                        </div>
                    </div>
                    <div id="phone2Section" style="display: none;">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">é›»è©±ç•ªå·2</label>
                                <input type="tel" class="form-input" name="phone2" placeholder="ä¾‹ï¼š090-1234-5678">
                            </div>
                            <div class="form-group">
                                <label class="form-label">é›»è©±ç•ªå·2åŒºåˆ†</label>
                                <select class="form-select" name="phoneType2">
                                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                    <option value="è‡ªå®…">è‡ªå®…</option>
                                    <option value="æºå¸¯">æºå¸¯</option>
                                    <option value="é…å¶è€…">é…å¶è€…</option>
                                    <option value="å®¶æ—ãƒ»è¦ªæˆš">å®¶æ—ãƒ»è¦ªæˆš</option>
                                    <option value="å®¶ä¸»ãƒ»ç®¡ç†äºº">å®¶ä¸»ãƒ»ç®¡ç†äºº</option>
                                    <option value="äº‹å‹™æ‰€">äº‹å‹™æ‰€</option>
                                    <option value="ãã®ä»–">ãã®ä»–</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" style="text-align: center; margin-top: 15px;">
                        <button type="button" class="btn-add-phone" id="addPhoneBtn" onclick="addPhone2()">é›»è©±ç•ªå·2ã‚’è¿½åŠ </button>
                        <button type="button" class="btn-remove-phone" id="removePhoneBtn" onclick="removePhone2()" style="display: none;">é›»è©±ç•ªå·2ã‚’å‰Šé™¤</button>
                    </div>
                </div>

                <!-- ã‚¬ã‚¹åˆ©ç”¨ã®å ´åˆã®ã¿è¡¨ç¤ºã•ã‚Œã‚‹é …ç›® -->
                <div class="form-section" id="gasSection" style="display: none;">
                    <h4>ã‚¬ã‚¹é–‹æ “ã«é–¢ã™ã‚‹æƒ…å ±</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ã‚¬ã‚¹ä½¿ç”¨é–‹å§‹æ—¥<span class="required">*</span></label>
                            <input type="date" class="form-input" name="gasStartDate">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ç«‹ã¡åˆã„å¸Œæœ›æ™‚åˆ»<span class="required">*</span></label>
                            <select class="form-select" name="gasTime">
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="9:00-12:00">9:00-12:00</option>
                                <option value="13:00-17:00">13:00-17:00</option>
                                <option value="9:00-17:00">9:00-17:00ï¼ˆçµ‚æ—¥ï¼‰</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">é–‹æ “ç«‹ä¼šè€…<span class="required">*</span></label>
                            <select class="form-select" name="gasWitness">
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="ã”å¥‘ç´„è€…">ã”å¥‘ç´„è€…</option>
                                <option value="ãŠç”³è¾¼è€…">ãŠç”³è¾¼è€…</option>
                                <option value="ãã®ä»–">ãã®ä»–</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">å…±ç”¨ç„é–¢ã‚„é–€æ‰‰ã®æ–½éŒ æœ‰ç„¡<span class="required">*</span></label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="lockStatus" value="ã‚ã‚Š">
                                    <span>ã‚ã‚Š</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="lockStatus" value="ãªã—">
                                    <span>ãªã—</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-prev" onclick="prevStep()">å‰ã¸æˆ»ã‚‹</button>
                    <button type="button" class="btn-next" onclick="nextStep()">æ¬¡ã¸é€²ã‚€</button>
                </div>
            </div>

            <!-- Step 3: åˆ©ç”¨é–‹å§‹æ—¥ãƒ»æ”¯æ‰•æ–¹æ³•è¨­å®š -->
            <div class="form-step" id="step3Form">
                <div class="step-header">
                    <h3>Step 3: ã”åˆ©ç”¨é–‹å§‹æ—¥ã€æ”¯æ‰•æ–¹æ³•ã®è¨­å®š</h3>
                    <p>åˆ©ç”¨é–‹å§‹æ—¥ã¨ãŠæ”¯æ‰•ã„æ–¹æ³•ã‚’ã”è¨­å®šãã ã•ã„</p>
                </div>

                <div class="form-section">
                    <h4>åˆ©ç”¨é–‹å§‹æ—¥ã®è¨­å®š</h4>
                    <div class="form-group full-width">
                        <label class="form-label">ä½¿ç”¨é–‹å§‹å¸Œæœ›æ—¥<span class="required">*</span></label>
                        <input type="date" class="form-input" name="startDate" required>
                    </div>
                    <div class="info-display">
                        <h4>ğŸ“… åˆ©ç”¨é–‹å§‹æ—¥ã«ã¤ã„ã¦</h4>
                        <p>â€¢ ç”³ã—è¾¼ã¿æ—¥ã‹ã‚‰æœ€çŸ­ã§3å–¶æ¥­æ—¥å¾Œã‹ã‚‰åˆ©ç”¨é–‹å§‹å¯èƒ½ã§ã™<br>
                        â€¢ å·¥äº‹ãŒå¿…è¦ãªå ´åˆã¯ã€åˆ¥é€”æ—¥ç¨‹èª¿æ•´ã‚’è¡Œã„ã¾ã™<br>
                        â€¢ ç·Šæ€¥ã®å ´åˆã¯ã€ãŠé›»è©±ã§ã”ç›¸è«‡ãã ã•ã„ï¼ˆ0120-986-807ï¼‰</p>
                    </div>
                </div>

                <div class="form-section">
                    <h4>æ”¯æ‰•ã„æ–¹æ³•ã®è¨­å®š</h4>
                    <div class="form-group full-width">
                        <label class="form-label">æ”¯æ‰•ã„æ–¹æ³•<span class="required">*</span></label>
                        <select class="form-select" name="paymentMethod" required>
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="bank">å£åº§æŒ¯æ›¿ï¼ˆæ‰‹æ•°æ–™ç„¡æ–™ï¼‰</option>
                            <option value="credit">ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰</option>
                            <option value="convenience">ã‚³ãƒ³ãƒ“ãƒ‹æ‰•ã„</option>
                        </select>
                    </div>
                </div>

                <div class="form-section">
                    <h4>å‚™è€ƒ</h4>
                    <div class="form-group full-width">
                        <label class="form-label">ãã®ä»–ã”è¦æœ›ãƒ»ã”è³ªå•</label>
                        <textarea class="form-textarea" name="notes" placeholder="ã”è¦æœ›ã‚„ã”è³ªå•ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠæ›¸ããã ã•ã„ã€‚"></textarea>
                    </div>
                </div>

                <!-- ç”³ã—è¾¼ã¿å†…å®¹ç¢ºèª -->
                <div class="info-display">
                    <h4>ğŸ“‹ ç”³ã—è¾¼ã¿å†…å®¹ã®ç¢ºèª</h4>
                    <div class="info-grid" id="summaryGrid">
                        <!-- å‹•çš„ã«ç”³ã—è¾¼ã¿å†…å®¹ãŒè¡¨ç¤ºã•ã‚Œã‚‹ -->
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-prev" onclick="prevStep()">å‰ã¸æˆ»ã‚‹</button>
                    <button type="submit" class="btn-submit" onclick="submitApplication()">ç”³ã—è¾¼ã¿ã‚’å®Œäº†ã™ã‚‹</button>
                </div>
            </div>
        </div>
    </main>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>ä¹å·é›»åŠ›æ ªå¼ä¼šç¤¾</h4>
                    <p>ã€’810-8720<br>
                    ç¦å²¡çœŒç¦å²¡å¸‚ä¸­å¤®åŒºæ¸¡è¾ºé€š2ä¸ç›®1ç•ª82å·<br>
                    TEL: 092-761-3030</p>
                </div>
                <div class="footer-section">
                    <h4>ã‚µãƒãƒ¼ãƒˆ</h4>
                    <ul class="footer-links">
                        <li><a href="#">ã‚ˆãã‚ã‚‹è³ªå•</a></li>
                        <li><a href="#">ãŠå•ã„åˆã‚ã›</a></li>
                        <li><a href="#">ã‚µã‚¤ãƒˆãƒãƒƒãƒ—</a></li>
                        <li><a href="#">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 ä¹å·é›»åŠ›æ ªå¼ä¼šç¤¾ All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        let currentStep = 1;
        const totalSteps = 3;
        let applicationData = {};

        const planDetails = {
            smartFamily: {
                name: 'ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚¡ãƒŸãƒªãƒ¼ãƒ—ãƒ©ãƒ³',
                description: 'ã”å®¶åº­å‘ã‘ã®åŸºæœ¬çš„ãªãƒ—ãƒ©ãƒ³',
                features: ['æ™‚é–“å¸¯åˆ¥æ–™é‡‘', 'ä½¿ç”¨é‡ã«å¿œã˜ãŸå‰²å¼•', 'é•·æœŸå¥‘ç´„å‰²å¼•'],
                price: 'ä½¿ç”¨é‡ã«å¿œã˜ã¦å¤‰å‹•'
            },
            nightSelect: {
                name: 'ãƒŠã‚¤ãƒˆã‚»ãƒ¬ã‚¯ãƒˆ',
                description: 'å¤œé–“ã®é›»æ°—ä½¿ç”¨ãŒå¤šã„æ–¹å‘ã‘',
                features: ['å¤œé–“æ–™é‡‘ãŒå‰²å®‰', 'ã‚¨ã‚³ã‚­ãƒ¥ãƒ¼ãƒˆåˆ©ç”¨è€…ã«æœ€é©', 'ç”Ÿæ´»ã‚¹ã‚¿ã‚¤ãƒ«ã«åˆã‚ã›ã‚„ã™ã„'],
                price: 'å¤œé–“æ–™é‡‘: 22æ™‚ã€œç¿Œ8æ™‚'
            },
            denkaNightSelect: {
                name: 'é›»åŒ–ã§ãƒŠã‚¤ãƒˆã‚»ãƒ¬ã‚¯ãƒˆ',
                description: 'ã‚ªãƒ¼ãƒ«é›»åŒ–ä½å®…å‘ã‘ã®å¤œé–“ãŠå¾—ãƒ—ãƒ©ãƒ³',
                features: ['å¤œé–“ãƒ»ä¼‘æ—¥ã®æ–™é‡‘ãŒå‰²å®‰', 'ã‚¨ã‚³ã‚­ãƒ¥ãƒ¼ãƒˆã‚„IHã«æœ€é©', 'é›»åŒ–ä½å®…ã®å…‰ç†±è²»å‰Šæ¸›'],
                price: 'å¤œé–“ãƒ»ä¼‘æ—¥æ–™é‡‘ãŒãŠå¾—'
            },
            ohisamaHiruToku: {
                name: 'ãŠã²ã•ã¾æ˜¼ãƒˆã‚¯ãƒ—ãƒ©ãƒ³',
                description: 'å¤ªé™½å…‰ç™ºé›»ãƒ»è“„é›»æ± ã‚’ãŠæŒã¡ã®æ–¹å‘ã‘',
                features: ['æ˜¼é–“ã®è²·é›»ãŒãŠå¾—', 'è‡ªå®¶æ¶ˆè²»ã‚’ã‚µãƒãƒ¼ãƒˆ', 'ç’°å¢ƒã«ã‚„ã•ã—ã„'],
                price: 'æ˜¼é–“ï¼ˆ10æ™‚ã€œ16æ™‚ï¼‰ã®é›»æ°—æ–™é‡‘ãŒãŠå¾—'
            },
            jolightB: {
                name: 'å¾“é‡é›»ç¯B',
                description: 'ä¸€èˆ¬çš„ãªã”å®¶åº­å‘ã‘ã®æ¨™æº–ãƒ—ãƒ©ãƒ³',
                features: ['ã‚·ãƒ³ãƒ—ãƒ«ãªæ–™é‡‘ä½“ç³»', '3æ®µéšæ–™é‡‘åˆ¶', 'å®‰å®šã—ãŸä¾›çµ¦'],
                price: 'åŸºæœ¬æ–™é‡‘: å¥‘ç´„å®¹é‡Ã—å˜ä¾¡'
            },
            jalDenkiB: {
                name: 'JALã§ã‚“ãB',
                description: 'é›»æ°—æ–™é‡‘ã§ãƒã‚¤ãƒ«ãŒè²¯ã¾ã‚‹ãƒ—ãƒ©ãƒ³',
                features: ['JALãƒã‚¤ãƒ«ãŒè²¯ã¾ã‚‹', 'æ—…è¡Œå¥½ãã«ãŠã™ã™ã‚', 'å¾“é‡é›»ç¯Bã¨åŒã˜æ–™é‡‘ä½“ç³»'],
                price: 'é›»æ°—æ–™é‡‘ã«å¿œã˜ã¦ãƒã‚¤ãƒ«ä»˜ä¸'
            }
        };

        function findPlan() {
            const familyComp = document.getElementById('familyComposition').value;
            const youngChildren = document.getElementById('youngChildren').value;
            const migrated = document.getElementById('migrated').value;
            const amperage = document.getElementById('amperage').value;
            const daytimeUsage = document.getElementById('daytimeUsage').value;
            const allElectric = document.getElementById('allElectric').value;
            const equipmentCheckboxes = document.querySelectorAll('#equipmentCheckboxes input[name="equipment"]:checked');
            const equipment = Array.from(equipmentCheckboxes).map(cb => cb.value);
            const jalMileage = document.getElementById('jalMileage').value;

            if (!familyComp || !youngChildren || !amperage || !migrated || !daytimeUsage || !allElectric || !jalMileage) {
                alert('ã™ã¹ã¦ã®é …ç›®ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
                return;
            }

            const planResultSection = document.getElementById('planResultSection');
            const planResult = document.getElementById('planResult');
            const discountInfo = document.getElementById('discountInfo');
            const discountText = document.getElementById('discountText');
            planResult.innerHTML = '';
            
            let recommendedPlans = new Set();
            let discountMessages = [];

            // Discount logic
            if (youngChildren !== "0äºº") {
                discountMessages.push('ã™ãã™ãèµ¤ã¡ã‚ƒã‚“ãƒ—ãƒ©ãƒ³ï¼ˆæ¯æœˆ100å††å‰²å¼•ï¼‰');
            }
            if (migrated === 'yes') {
                discountMessages.push('IJUã‚¿ãƒ¼ãƒ³å¿œæ´ãƒ—ãƒ©ãƒ³ï¼ˆæ¯æœˆ200å††å‰²å¼•ï¼‰');
            }
            if (applicationData.gasSet === 'yes') {
                discountMessages.push('<b>ã‚¬ã‚¹ã‚»ãƒƒãƒˆãƒ—ãƒ©ãƒ³ï¼ˆæ¯æœˆ300å††å‰²å¼•ï¼‰</b>');
            }

            if (discountMessages.length > 0) {
                discountText.innerHTML = discountMessages.join('<br>');
                discountInfo.style.display = 'block';
            } else {
                discountInfo.style.display = 'none';
            }

            // Plan recommendation logic
            if (allElectric === 'yes') {
                recommendedPlans.add('denkaNightSelect');
                if (equipment.includes('storage') || equipment.includes('ev')) {
                    recommendedPlans.add('ohisamaHiruToku');
                }
            } else {
                if (daytimeUsage === 'no' || equipment.includes('ecocute')) {
                    recommendedPlans.add('nightSelect');
                } else {
                    recommendedPlans.add('smartFamily');
                }
                if (daytimeUsage === 'yes' || equipment.length > 0) {
                    recommendedPlans.add('ohisamaHiruToku');
                }
                recommendedPlans.add('jolightB');
            }
            if (jalMileage === 'yes') {
                recommendedPlans.add('jalDenkiB');
            }
            
            // Create plan cards for recommended plans
            recommendedPlans.forEach(planKey => {
                const plan = planDetails[planKey];
                const card = document.createElement('div');
                card.className = 'plan-card';
                card.setAttribute('data-plan', planKey);
                card.innerHTML = `
                    <h4>${plan.name}</h4>
                    <p>${plan.description}</p>
                    <ul class="plan-features">
                        ${plan.features.map(f => `<li>${f}</li>`).join('')}
                    </ul>
                    <div class="plan-price">${plan.price}</div>
                `;
                card.addEventListener('click', function() {
                    document.querySelectorAll('#planResult .plan-card').forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    applicationData.plan = this.getAttribute('data-plan');
                    document.getElementById('step1NextButton').style.display = 'inline-block';
                });
                planResult.appendChild(card);
            });
            
            planResultSection.style.display = 'block';
        }

        // ã‚¹ãƒ†ãƒƒãƒ—ç®¡ç†
        function showStep(step) {
            // å…¨ã¦ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’éè¡¨ç¤º
            document.querySelectorAll('.form-step').forEach(form => {
                form.classList.remove('active');
            });
            
            // æŒ‡å®šã•ã‚ŒãŸã‚¹ãƒ†ãƒƒãƒ—ã‚’è¡¨ç¤º
            document.getElementById(`step${step}Form`).classList.add('active');
            
            // ã‚¹ãƒ†ãƒƒãƒ—ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’æ›´æ–°
            updateStepIndicators(step);
        }

        function updateStepIndicators(activeStep) {
            document.querySelectorAll('.step-item').forEach((item, index) => {
                item.classList.remove('active', 'completed');
                if (index + 1 < activeStep) {
                    item.classList.add('completed');
                } else if (index + 1 === activeStep) {
                    item.classList.add('active');
                }
            });
        }

        function nextStep() {
            if (validateCurrentStep()) {
                saveCurrentStepData();
                if (currentStep < totalSteps) {
                    currentStep++;
                    showStep(currentStep);
                    if (currentStep === 3) {
                        updateSummary();
                    }
                }
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
            }
        }

        function validateCurrentStep() {
            const currentForm = document.getElementById(`step${currentStep}Form`);
            const requiredFields = currentForm.querySelectorAll('[required]');
            let isValid = true;

            for (const field of requiredFields) {
                if (!field.value.trim()) {
                    field.style.borderColor = '#ef4444';
                    isValid = false;
                } else {
                    field.style.borderColor = '#e2e8f0';
                }
            }

            if (!isValid) {
                alert('å¿…é ˆé …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
                return false;
            }

            if (currentStep === 1) {
                if (!applicationData.plan) {
                    alert('ã€Œæœ€é©ãªãƒ—ãƒ©ãƒ³ã‚’æ¤œç´¢ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã€ã”å¸Œæœ›ã®ãƒ—ãƒ©ãƒ³ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
                    return false;
                }
            }

            return true;
        }

        function saveCurrentStepData() {
            const currentForm = document.getElementById(`step${currentStep}Form`);
            const formData = new FormData(currentForm);
            
            for (let [key, value] of formData.entries()) {
                applicationData[key] = value;
            }
        }

        function updateSummary() {
            const summaryGrid = document.getElementById('summaryGrid');
            summaryGrid.innerHTML = `
                <div class="info-item">
                    <span class="info-label">é¸æŠãƒ—ãƒ©ãƒ³:</span>
                    <span class="info-value">${getPlanName(applicationData.plan)}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">å¥‘ç´„å®¹é‡:</span>
                    <span class="info-value">${applicationData.capacity}A</span>
                </div>
                <div class="info-item">
                    <span class="info-label">å®¶æ—æ§‹æˆ:</span>
                    <span class="info-value">${applicationData.familyComposition}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">3æ­³æœªæº€ã®ãŠå­æ§˜:</span>
                    <span class="info-value">${applicationData.youngChildren}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">æ˜¼é–“ã®é›»æ°—ä½¿ç”¨:</span>
                    <span class="info-value">${applicationData.daytimeUsage === 'yes' ? 'ã‚ã‚Š' : 'ãªã—'}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">ãŠä½ã¾ã„ã¯ã‚ªãƒ¼ãƒ«é›»åŒ–:</span>
                    <span class="info-value">${applicationData.allElectric === 'yes' ? 'ã¯ã„' : 'ã„ã„ãˆ'}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">ç‰¹å®šè¨­å‚™:</span>
                    <span class="info-value">${applicationData.equipment && applicationData.equipment.length ? applicationData.equipment.join(', ') : 'ãªã—'}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">JALãƒã‚¤ãƒ¬ãƒ¼ã‚¸å¸Œæœ›:</span>
                    <span class="info-value">${applicationData.jalMileage === 'yes' ? 'ã¯ã„' : 'ã„ã„ãˆ'}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">ãŠåå‰:</span>
                    <span class="info-value">${applicationData.lastName} ${applicationData.firstName}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹:</span>
                    <span class="info-value">${applicationData.email}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">æ”¯æ‰•ã„æ–¹æ³•:</span>
                    <span class="info-value">${getPaymentMethodName(applicationData.paymentMethod)}</span>
                </div>
            `;
        }

        function getPlanName(plan) {
            return planDetails[plan] ? planDetails[plan].name : 'æœªé¸æŠ';
        }

        function getPaymentMethodName(method) {
            const methods = {
                'bank': 'å£åº§æŒ¯æ›¿',
                'credit': 'ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰',
                'convenience': 'ã‚³ãƒ³ãƒ“ãƒ‹æ‰•ã„'
            };
            return methods[method] || 'æœªé¸æŠ';
        }

        function submitApplication() {
            if (validateCurrentStep()) {
                saveCurrentStepData();
                
                // é€ä¿¡å‡¦ç†ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                alert('ç”³ã—è¾¼ã¿ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼\n\nç¢ºèªãƒ¡ãƒ¼ãƒ«ã‚’1-2å–¶æ¥­æ—¥ä»¥å†…ã«ãŠé€ã‚Šã„ãŸã—ã¾ã™ã€‚\nã”ç™»éŒ²ã„ãŸã ã„ãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã”ç¢ºèªãã ã•ã„ã€‚');
                
                // ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
                window.location.href = 'index.html';
            }
        }

        // ãƒ—ãƒ©ãƒ³é¸æŠ
        document.querySelectorAll('.plan-card').forEach(card => {
            card.addEventListener('click', function() {
                document.querySelectorAll('.plan-card').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                
                // ãƒ—ãƒ©ãƒ³æƒ…å ±ã‚’ä¿å­˜
                const plan = this.getAttribute('data-plan');
                const planName = this.querySelector('h4').textContent;
                applicationData.plan = plan;
                applicationData.planName = planName;
            });
        });

        // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆæƒ…å ±ã¨ã‚¬ã‚¹ã‚»ãƒƒãƒˆæƒ…å ±ã‚’å–å¾—
        function loadInitialInfo() {
            const urlParams = new URLSearchParams(window.location.search);
            
            // ã‚¬ã‚¹ã‚»ãƒƒãƒˆå‰²å¼•ã®å‡¦ç†
            if (urlParams.get('gasSet') === 'true') {
                applicationData.gasSet = 'yes';
            }

            const familySize = urlParams.get('family');
            const usagePattern = urlParams.get('usage');
            const plan = urlParams.get('plan');

            if (familySize || usagePattern || plan) {
                const preInfo = document.getElementById('preInfo');
                const preInfoGrid = document.getElementById('preInfoGrid');
                
                preInfo.style.display = 'block';
                preInfoGrid.innerHTML = '';
                
                if (familySize) {
                    preInfoGrid.innerHTML += `
                        <div class="info-item">
                            <span class="info-label">å®¶æ—æ§‹æˆ:</span>
                            <span class="info-value">${familySize}</span>
                        </div>
                    `;
                }
                
                if (usagePattern) {
                    preInfoGrid.innerHTML += `
                        <div class="info-item">
                            <span class="info-label">ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³:</span>
                            <span class="info-value">${usagePattern}</span>
                        </div>
                    `;
                }
                
                if (plan) {
                    preInfoGrid.innerHTML += `
                        <div class="info-item">
                            <span class="info-label">æ¨å¥¨ãƒ—ãƒ©ãƒ³:</span>
                            <span class="info-value">${planDetails[plan] ? planDetails[plan].name : plan}</span>
                        </div>
                    `;
                    
                    // æ¨å¥¨ãƒ—ãƒ©ãƒ³ã‚’è‡ªå‹•é¸æŠï¼ˆã“ã®æ©Ÿèƒ½ã¯è³ªå•ãƒ™ãƒ¼ã‚¹ã®ææ¡ˆã«å¤‰æ›´ã•ã‚ŒãŸãŸã‚ã€ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã¾ãŸã¯å‰Šé™¤ï¼‰
                    // const planCard = document.querySelector(`[data-plan="${plan}"]`);
                    // if (planCard) {
                    //     planCard.click();
                    // }
                }
            }
        }

        // é›»è©±ç•ªå·2ã®è¿½åŠ ãƒ»å‰Šé™¤æ©Ÿèƒ½
        function addPhone2() {
            document.getElementById('phone2Section').style.display = 'block';
            document.getElementById('addPhoneBtn').style.display = 'none';
            document.getElementById('removePhoneBtn').style.display = 'inline-block';
        }

        function removePhone2() {
            document.getElementById('phone2Section').style.display = 'none';
            document.getElementById('addPhoneBtn').style.display = 'inline-block';
            document.getElementById('removePhoneBtn').style.display = 'none';
            // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ã‚’ã‚¯ãƒªã‚¢
            document.querySelector('input[name="phone2"]').value = '';
            document.querySelector('select[name="phoneType2"]').value = '';
        }

        // ä½æ‰€æ¤œç´¢æ©Ÿèƒ½ï¼ˆãƒ‡ãƒ¢ï¼‰
        function searchAddress() {
            alert('ä½æ‰€æ¤œç´¢æ©Ÿèƒ½ã¯ãƒ‡ãƒ¢ã§ã™ã€‚\nå®Ÿéš›ã®é‹ç”¨ã§ã¯éƒµä¾¿ç•ªå·APIã¨é€£æºã—ã¦è‡ªå‹•å…¥åŠ›ã•ã‚Œã¾ã™ã€‚');
        }

        // ã‚¬ã‚¹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡
        function toggleGasSection() {
            const gasSection = document.getElementById('gasSection');
            const gasFields = gasSection.querySelectorAll('[required]');
            
            if (applicationData.gasSet === 'yes') {
                gasSection.style.display = 'block';
                // ã‚¬ã‚¹é–¢é€£ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å¿…é ˆã«ã™ã‚‹
                gasFields.forEach(field => {
                    field.setAttribute('required', 'required');
                });
            } else {
                gasSection.style.display = 'none';
                // ã‚¬ã‚¹é–¢é€£ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å¿…é ˆå±æ€§ã‚’å‰Šé™¤
                gasFields.forEach(field => {
                    field.removeAttribute('required');
                });
            }
        }

        // ã‚¹ãƒ†ãƒƒãƒ—ç®¡ç†ã‚’æ›´æ–°ï¼ˆã‚¬ã‚¹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡ã‚’å«ã‚€ï¼‰
        function showStep(step) {
            // å…¨ã¦ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’éè¡¨ç¤º
            document.querySelectorAll('.form-step').forEach(form => {
                form.classList.remove('active');
            });
            
            // æŒ‡å®šã•ã‚ŒãŸã‚¹ãƒ†ãƒƒãƒ—ã‚’è¡¨ç¤º
            document.getElementById(`step${step}Form`).classList.add('active');
            
            // Step2ã®å ´åˆã€ã‚¬ã‚¹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡
            if (step === 2) {
                toggleGasSection();
            }
            
            // ã‚¹ãƒ†ãƒƒãƒ—ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’æ›´æ–°
            updateStepIndicators(step);
        }

        // åˆæœŸåŒ–
        window.addEventListener('load', function() {
            loadInitialInfo();
            showStep(1);
        });
    </script>
</body>
</html>

